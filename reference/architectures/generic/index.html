
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for MMUShell">
      
      
      
        <link rel="canonical" href="https://memoscopy.github.io/mmushell/reference/architectures/generic/">
      
      
        <link rel="prev" href="../../exporter/">
      
      
        <link rel="next" href="../aarch64/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.19">
    
    
      
        <title>Generic - MMUShell</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.66ac8b77.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#generic" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="MMUShell" class="md-header__button md-logo" aria-label="MMUShell" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MMUShell
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Generic
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Memoscopy/mmushell" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Memoscopy/mmushell
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../tutorials/" class="md-tabs__link">
        
  
    
  
  Tutorials

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../how-to-guides/" class="md-tabs__link">
        
  
    
  
  How to guides

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../reference/" class="md-tabs__link">
          
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../explanation/" class="md-tabs__link">
        
  
    
  
  Explanation

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="MMUShell" class="md-nav__button md-logo" aria-label="MMUShell" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    MMUShell
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Memoscopy/mmushell" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Memoscopy/mmushell
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../how-to-guides/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to guides
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mmushell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MMUShell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exporter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exporter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Architectures
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Architectures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Generic
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Generic
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#generic" class="md-nav__link">
    <span class="md-ellipsis">
      Generic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic" class="md-nav__link">
    <span class="md-ellipsis">
      generic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU" class="md-nav__link">
    <span class="md-ellipsis">
      CPU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CPU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.extract_bits_big" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_big
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.extract_bits_big64" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_big64
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.extract_bits_little" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_little
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.find_registers_values_dataflow" class="md-nav__link">
    <span class="md-ellipsis">
      find_registers_values_dataflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.from_cpu_config" class="md-nav__link">
    <span class="md-ellipsis">
      from_cpu_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.parse_opcode" class="md-nav__link">
    <span class="md-ellipsis">
      parse_opcode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.parse_opcodes_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      parse_opcodes_parallel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPUReg" class="md-nav__link">
    <span class="md-ellipsis">
      CPUReg
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CPUReg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPUReg.__hash__" class="md-nav__link">
    <span class="md-ellipsis">
      __hash__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPUReg.is_mmu_equivalent_to" class="md-nav__link">
    <span class="md-ellipsis">
      is_mmu_equivalent_to
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPUReg.is_valid" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMU" class="md-nav__link">
    <span class="md-ellipsis">
      MMU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MMU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMU.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMU.extract_bits_big" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_big
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMU.extract_bits_big64" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_big64
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMU.extract_bits_little" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_little
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix" class="md-nav__link">
    <span class="md-ellipsis">
      MMURadix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MMURadix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix.classify_entry" class="md-nav__link">
    <span class="md-ellipsis">
      classify_entry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix.classify_frame" class="md-nav__link">
    <span class="md-ellipsis">
      classify_frame
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix.derive_page_address" class="md-nav__link">
    <span class="md-ellipsis">
      derive_page_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix.parse_frame" class="md-nav__link">
    <span class="md-ellipsis">
      parse_frame
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix.parse_parallel_frame" class="md-nav__link">
    <span class="md-ellipsis">
      parse_parallel_frame
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell" class="md-nav__link">
    <span class="md-ellipsis">
      MMUShell
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MMUShell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell.do_exit" class="md-nav__link">
    <span class="md-ellipsis">
      do_exit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell.do_ipython" class="md-nav__link">
    <span class="md-ellipsis">
      do_ipython
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell.do_save_data" class="md-nav__link">
    <span class="md-ellipsis">
      do_save_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell.physpace" class="md-nav__link">
    <span class="md-ellipsis">
      physpace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell.virtspace" class="md-nav__link">
    <span class="md-ellipsis">
      virtspace
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.Machine" class="md-nav__link">
    <span class="md-ellipsis">
      Machine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.Machine.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.Machine.apply_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      apply_parallel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.Machine.from_machine_config" class="md-nav__link">
    <span class="md-ellipsis">
      from_machine_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.Machine.get_miasm_machine" class="md-nav__link">
    <span class="md-ellipsis">
      get_miasm_machine
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS" class="md-nav__link">
    <span class="md-ellipsis">
      PAS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PAS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.__contains__" class="md-nav__link">
    <span class="md-ellipsis">
      __contains__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.get_kernel_size" class="md-nav__link">
    <span class="md-ellipsis">
      get_kernel_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.get_user_size" class="md-nav__link">
    <span class="md-ellipsis">
      get_user_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.hierarchical_extend" class="md-nav__link">
    <span class="md-ellipsis">
      hierarchical_extend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.is_in_kernel_space" class="md-nav__link">
    <span class="md-ellipsis">
      is_in_kernel_space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.is_in_kernel_x_space" class="md-nav__link">
    <span class="md-ellipsis">
      is_in_kernel_x_space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.is_in_user_space" class="md-nav__link">
    <span class="md-ellipsis">
      is_in_user_space
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PageTable" class="md-nav__link">
    <span class="md-ellipsis">
      PageTable
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PageTable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PageTable.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PageTable.apply_on_entries" class="md-nav__link">
    <span class="md-ellipsis">
      apply_on_entries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory" class="md-nav__link">
    <span class="md-ellipsis">
      PhysicalMemory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PhysicalMemory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__contains__" class="md-nav__link">
    <span class="md-ellipsis">
      __contains__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__copy__" class="md-nav__link">
    <span class="md-ellipsis">
      __copy__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__deepcopy__" class="md-nav__link">
    <span class="md-ellipsis">
      __deepcopy__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__getstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __getstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __setstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.free_miasm_memory" class="md-nav__link">
    <span class="md-ellipsis">
      free_miasm_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.get_addresses" class="md-nav__link">
    <span class="md-ellipsis">
      get_addresses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.get_memregions" class="md-nav__link">
    <span class="md-ellipsis">
      get_memregions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.get_miasm_vmmngr" class="md-nav__link">
    <span class="md-ellipsis">
      get_miasm_vmmngr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.reopen" class="md-nav__link">
    <span class="md-ellipsis">
      reopen
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.RadixTree" class="md-nav__link">
    <span class="md-ellipsis">
      RadixTree
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RadixTree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.RadixTree.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.RadixTree.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.RadixTree.entry_resume" class="md-nav__link">
    <span class="md-ellipsis">
      entry_resume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.RadixTree.entry_resume_stringified" class="md-nav__link">
    <span class="md-ellipsis">
      entry_resume_stringified
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.TableEntry" class="md-nav__link">
    <span class="md-ellipsis">
      TableEntry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TableEntry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.TableEntry.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.VAS" class="md-nav__link">
    <span class="md-ellipsis">
      VAS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="VAS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.VAS.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.VAS.hierarchical_extend" class="md-nav__link">
    <span class="md-ellipsis">
      hierarchical_extend
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.perms_bool_to_string" class="md-nav__link">
    <span class="md-ellipsis">
      perms_bool_to_string
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aarch64/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AArch64
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../arm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../riscv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RISC-V
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MIPS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PowerPC
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../explanation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Explanation
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#generic" class="md-nav__link">
    <span class="md-ellipsis">
      Generic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic" class="md-nav__link">
    <span class="md-ellipsis">
      generic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU" class="md-nav__link">
    <span class="md-ellipsis">
      CPU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CPU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.extract_bits_big" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_big
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.extract_bits_big64" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_big64
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.extract_bits_little" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_little
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.find_registers_values_dataflow" class="md-nav__link">
    <span class="md-ellipsis">
      find_registers_values_dataflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.from_cpu_config" class="md-nav__link">
    <span class="md-ellipsis">
      from_cpu_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.parse_opcode" class="md-nav__link">
    <span class="md-ellipsis">
      parse_opcode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPU.parse_opcodes_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      parse_opcodes_parallel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPUReg" class="md-nav__link">
    <span class="md-ellipsis">
      CPUReg
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CPUReg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPUReg.__hash__" class="md-nav__link">
    <span class="md-ellipsis">
      __hash__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPUReg.is_mmu_equivalent_to" class="md-nav__link">
    <span class="md-ellipsis">
      is_mmu_equivalent_to
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.CPUReg.is_valid" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMU" class="md-nav__link">
    <span class="md-ellipsis">
      MMU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MMU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMU.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMU.extract_bits_big" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_big
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMU.extract_bits_big64" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_big64
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMU.extract_bits_little" class="md-nav__link">
    <span class="md-ellipsis">
      extract_bits_little
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix" class="md-nav__link">
    <span class="md-ellipsis">
      MMURadix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MMURadix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix.classify_entry" class="md-nav__link">
    <span class="md-ellipsis">
      classify_entry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix.classify_frame" class="md-nav__link">
    <span class="md-ellipsis">
      classify_frame
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix.derive_page_address" class="md-nav__link">
    <span class="md-ellipsis">
      derive_page_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix.parse_frame" class="md-nav__link">
    <span class="md-ellipsis">
      parse_frame
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMURadix.parse_parallel_frame" class="md-nav__link">
    <span class="md-ellipsis">
      parse_parallel_frame
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell" class="md-nav__link">
    <span class="md-ellipsis">
      MMUShell
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MMUShell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell.do_exit" class="md-nav__link">
    <span class="md-ellipsis">
      do_exit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell.do_ipython" class="md-nav__link">
    <span class="md-ellipsis">
      do_ipython
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell.do_save_data" class="md-nav__link">
    <span class="md-ellipsis">
      do_save_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell.physpace" class="md-nav__link">
    <span class="md-ellipsis">
      physpace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.MMUShell.virtspace" class="md-nav__link">
    <span class="md-ellipsis">
      virtspace
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.Machine" class="md-nav__link">
    <span class="md-ellipsis">
      Machine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.Machine.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.Machine.apply_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      apply_parallel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.Machine.from_machine_config" class="md-nav__link">
    <span class="md-ellipsis">
      from_machine_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.Machine.get_miasm_machine" class="md-nav__link">
    <span class="md-ellipsis">
      get_miasm_machine
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS" class="md-nav__link">
    <span class="md-ellipsis">
      PAS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PAS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.__contains__" class="md-nav__link">
    <span class="md-ellipsis">
      __contains__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.get_kernel_size" class="md-nav__link">
    <span class="md-ellipsis">
      get_kernel_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.get_user_size" class="md-nav__link">
    <span class="md-ellipsis">
      get_user_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.hierarchical_extend" class="md-nav__link">
    <span class="md-ellipsis">
      hierarchical_extend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.is_in_kernel_space" class="md-nav__link">
    <span class="md-ellipsis">
      is_in_kernel_space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.is_in_kernel_x_space" class="md-nav__link">
    <span class="md-ellipsis">
      is_in_kernel_x_space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PAS.is_in_user_space" class="md-nav__link">
    <span class="md-ellipsis">
      is_in_user_space
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PageTable" class="md-nav__link">
    <span class="md-ellipsis">
      PageTable
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PageTable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PageTable.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PageTable.apply_on_entries" class="md-nav__link">
    <span class="md-ellipsis">
      apply_on_entries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory" class="md-nav__link">
    <span class="md-ellipsis">
      PhysicalMemory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PhysicalMemory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__contains__" class="md-nav__link">
    <span class="md-ellipsis">
      __contains__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__copy__" class="md-nav__link">
    <span class="md-ellipsis">
      __copy__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__deepcopy__" class="md-nav__link">
    <span class="md-ellipsis">
      __deepcopy__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__getstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __getstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __setstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.free_miasm_memory" class="md-nav__link">
    <span class="md-ellipsis">
      free_miasm_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.get_addresses" class="md-nav__link">
    <span class="md-ellipsis">
      get_addresses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.get_memregions" class="md-nav__link">
    <span class="md-ellipsis">
      get_memregions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.get_miasm_vmmngr" class="md-nav__link">
    <span class="md-ellipsis">
      get_miasm_vmmngr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.PhysicalMemory.reopen" class="md-nav__link">
    <span class="md-ellipsis">
      reopen
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.RadixTree" class="md-nav__link">
    <span class="md-ellipsis">
      RadixTree
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RadixTree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.RadixTree.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.RadixTree.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.RadixTree.entry_resume" class="md-nav__link">
    <span class="md-ellipsis">
      entry_resume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.RadixTree.entry_resume_stringified" class="md-nav__link">
    <span class="md-ellipsis">
      entry_resume_stringified
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.TableEntry" class="md-nav__link">
    <span class="md-ellipsis">
      TableEntry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TableEntry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.TableEntry.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.VAS" class="md-nav__link">
    <span class="md-ellipsis">
      VAS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="VAS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.VAS.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.VAS.hierarchical_extend" class="md-nav__link">
    <span class="md-ellipsis">
      hierarchical_extend
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mmushell.architectures.generic.perms_bool_to_string" class="md-nav__link">
    <span class="md-ellipsis">
      perms_bool_to_string
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/Memoscopy/mmushell/edit/main/docs/reference/architectures/generic.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


  <h1>Generic</h1>

<h2 id="generic">Generic</h2>


<div class="doc doc-object doc-module">



<a id="mmushell.architectures.generic"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.CPU" class="doc doc-heading">
          <code>CPU</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Represents a generic CPU</p>
<p>A CPU is able to parse opcodes and to find the dataflow of the registers.</p>
<p>Aimed to be inherited by child classes to represent different architectures</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.CPU.architecture">architecture</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the architecture of the CPU</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.CPU.bits">bits</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the bits of the CPU</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.CPU.endianness">endianness</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the endianness of the CPU</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.CPU.processor_features">processor_features</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the processor features of the CPU</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.CPU.registers_values">registers_values</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the registers values of the CPU</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.CPU.opcode_to_mmu_regs">opcode_to_mmu_regs</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between opcodes and MMU registers</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.CPU.opcode_to_gregs">opcode_to_gregs</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between opcodes and general registers</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.CPU.machine">machine</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the machine of the CPU</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CPU</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a generic CPU</span>

<span class="sd">    A CPU is able to parse opcodes and to find the dataflow of the registers.</span>

<span class="sd">    Aimed to be inherited by child classes to represent different architectures</span>

<span class="sd">    Attributes:</span>
<span class="sd">        architecture: the architecture of the CPU</span>
<span class="sd">        bits: the bits of the CPU</span>
<span class="sd">        endianness: the endianness of the CPU</span>
<span class="sd">        processor_features: the processor features of the CPU</span>
<span class="sd">        registers_values: the registers values of the CPU</span>
<span class="sd">        opcode_to_mmu_regs: the mapping between opcodes and MMU registers</span>
<span class="sd">        opcode_to_gregs: the mapping between opcodes and general registers</span>
<span class="sd">        machine: the machine of the CPU</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">opcode_to_mmu_regs</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">opcode_to_gregs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_cpu_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">cpu_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a CPU starting from a YAML file descriptor</span>

<span class="sd">        Args:</span>
<span class="sd">            cpu_config: the YAML file descriptor</span>
<span class="sd">            **kwargs: additional arguments</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new CPU object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">CPU</span><span class="p">(</span><span class="n">cpu_config</span><span class="p">)</span>

    <span class="n">machine</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the CPU</span>

<span class="sd">        Args:</span>
<span class="sd">            params: the parameters of the CPU</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">architecture</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;architecture&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bits</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;bits&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endianness</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;endianness&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processor_features</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;processor_features&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registers_values</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;registers_values&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extract_bits_little</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in little endian</span>

<span class="sd">        Args:</span>
<span class="sd">            entry: the entry to extract bits from</span>
<span class="sd">            pos: the position of the bits</span>
<span class="sd">            n: the number of bits to extract</span>

<span class="sd">        Returns:</span>
<span class="sd">            the extracted bits</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="n">pos</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extract_bits_big</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in big endian</span>

<span class="sd">        Args:</span>
<span class="sd">            entry: the entry to extract bits from</span>
<span class="sd">            pos: the position of the bits</span>
<span class="sd">            n: the number of bits to extract</span>

<span class="sd">        Returns:</span>
<span class="sd">            the extracted bits</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">pos</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extract_bits_big64</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in big endian 64 bits</span>

<span class="sd">        Args:</span>
<span class="sd">            entry: the entry to extract bits from</span>
<span class="sd">            pos: the position of the bits</span>
<span class="sd">            n: the number of bits to extract</span>

<span class="sd">        Returns:</span>
<span class="sd">            the extracted bits</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">64</span> <span class="o">-</span> <span class="n">pos</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse_opcode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buff</span><span class="p">,</span> <span class="n">page_addr</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse an opcode</span>

<span class="sd">        Aimed to be overloaded by child classes</span>

<span class="sd">        Args:</span>
<span class="sd">            buff: the buffer to parse</span>
<span class="sd">            page_addr: the address of the page</span>
<span class="sd">            offset: the offset of the opcode</span>

<span class="sd">        Returns:</span>
<span class="sd">            the parsed opcode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">parse_opcodes_parallel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addresses</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse opcodes in parallel</span>

<span class="sd">        Every process sleep a random delay in order to desynchronise access to disk and maximixe the throuput</span>

<span class="sd">        Args:</span>
<span class="sd">            addresses: the addresses to parse</span>
<span class="sd">            frame_size: the size of the frame</span>
<span class="sd">            pidx: the process index</span>
<span class="sd">            **kwargs: additional arguments</span>

<span class="sd">        Returns:</span>
<span class="sd">            dictionnary of parsed opcodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Every process sleep a random delay in order to desincronize access to disk and maximixe the throuput</span>
        <span class="n">sleep</span><span class="p">(</span><span class="n">uniform</span><span class="p">(</span><span class="n">pidx</span><span class="p">,</span> <span class="n">pidx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">1000</span><span class="p">)</span>

        <span class="n">opcodes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">mm</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">memory</span><span class="p">)</span>
        <span class="n">mm</span><span class="o">.</span><span class="n">reopen</span><span class="p">()</span>

        <span class="c1"># Cicle over every frame</span>
        <span class="n">total_elems</span><span class="p">,</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">addresses</span>
        <span class="k">for</span> <span class="n">frame_addr</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
            <span class="n">iterator</span><span class="p">,</span> <span class="n">position</span><span class="o">=-</span><span class="n">pidx</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">total_elems</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">):</span>
            <span class="n">frame_buf</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span>
                <span class="n">frame_addr</span><span class="p">,</span> <span class="n">frame_size</span>
            <span class="p">)</span>  <span class="c1"># We parse memory in PAGE_SIZE chunks</span>

            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                <span class="n">iter_unpack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processor_features</span><span class="p">[</span><span class="s2">&quot;opcode_unpack_fmt&quot;</span><span class="p">],</span> <span class="n">frame_buf</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">opcode</span> <span class="o">=</span> <span class="n">opcode</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">opcodes</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parse_opcode</span><span class="p">(</span>
                        <span class="n">opcode</span><span class="p">,</span> <span class="n">frame_addr</span><span class="p">,</span> <span class="n">idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor_features</span><span class="p">[</span><span class="s2">&quot;instr_len&quot;</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">opcodes</span>

    <span class="k">def</span> <span class="nf">find_registers_values_dataflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opcodes</span><span class="p">,</span> <span class="n">zero_registers</span><span class="o">=</span><span class="p">[])</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the dataflow of the registers</span>

<span class="sd">        Args:</span>
<span class="sd">            opcodes: the opcodes to analyze</span>
<span class="sd">            zero_registers: the registers to ignore</span>

<span class="sd">        Returns:</span>
<span class="sd">            a dictionnary with the dataflow of the registers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Miasm require to define a memory() function to access to the underlaying</span>
        <span class="c1"># memory layer during the Python translation</span>
        <span class="c1"># WORKAROUND: memory() does not permit more than 2 args...</span>
        <span class="n">endianness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endianness</span>

        <span class="k">def</span> <span class="nf">memory</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">size</span><span class="p">),</span> <span class="n">endianness</span><span class="p">)</span>

        <span class="n">machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">get_miasm_machine</span><span class="p">()</span>
        <span class="n">vm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">get_miasm_vmmngr</span><span class="p">()</span>
        <span class="n">mdis</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">dis_engine</span><span class="p">(</span>
            <span class="n">bin_stream_vm</span><span class="p">(</span><span class="n">vm</span><span class="p">),</span> <span class="n">dont_dis_nulstart_bloc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc_db</span><span class="o">=</span><span class="n">LocationDB</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">ir_arch</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">ira</span><span class="p">(</span><span class="n">mdis</span><span class="o">.</span><span class="n">loc_db</span><span class="p">)</span>
        <span class="n">py_transl</span> <span class="o">=</span> <span class="n">TranslatorPython</span><span class="p">()</span>

        <span class="c1"># Disable MIASM logging</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;asmblock&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">registers_values</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="c1"># We use a stack data structure (deque) in order to also manage parent functions (EXPERIMENTAL not implemented here)</span>
        <span class="n">instr_deque</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">addr</span><span class="p">,</span> <span class="n">opcodes</span><span class="p">[</span><span class="n">addr</span><span class="p">])</span> <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="n">opcodes</span><span class="p">])</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">instr_deque</span><span class="p">):</span>
            <span class="n">instr_addr</span><span class="p">,</span> <span class="n">instr_data</span> <span class="o">=</span> <span class="n">instr_deque</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

            <span class="c1"># Ignore instruction with associated function not found</span>
            <span class="k">if</span> <span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;f_addr&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># Do not dataflow instructions with source registers in zero_registers</span>
            <span class="c1"># because contain zero</span>
            <span class="k">if</span> <span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;gpr&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">zero_registers</span><span class="p">:</span>
                <span class="n">registers_values</span><span class="p">[</span><span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;register&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1"># Disable disassemble logging for unimplemented opcodes</span>
            <span class="k">with</span> <span class="n">DisableLogs</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Initialize dependency graph machinery</span>
                    <span class="n">mdis</span><span class="o">.</span><span class="n">dont_dis</span> <span class="o">=</span> <span class="p">[</span><span class="n">instr_addr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor_features</span><span class="p">[</span><span class="s2">&quot;instr_len&quot;</span><span class="p">]]</span>
                    <span class="n">asmcfg</span> <span class="o">=</span> <span class="n">mdis</span><span class="o">.</span><span class="n">dis_multiblock</span><span class="p">(</span><span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;f_addr&quot;</span><span class="p">])</span>
                    <span class="n">ircfg</span> <span class="o">=</span> <span class="n">ir_arch</span><span class="o">.</span><span class="n">new_ircfg_from_asmcfg</span><span class="p">(</span><span class="n">asmcfg</span><span class="p">)</span>
                    <span class="n">dg</span> <span class="o">=</span> <span class="n">DependencyGraph</span><span class="p">(</span><span class="n">ircfg</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="c1"># Disassembler can raises exception if a JMP address is register dependent,</span>
                    <span class="c1"># in that case the analysis fails..</span>
                    <span class="c1"># print(e)</span>
                    <span class="c1"># traceback.print_exc()</span>
                    <span class="k">continue</span>

            <span class="c1"># Collect function informations</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">current_loc_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ircfg</span><span class="o">.</span><span class="n">getby_offset</span><span class="p">(</span><span class="n">instr_addr</span><span class="p">)))</span>
                <span class="n">assignblk_index</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">current_block</span> <span class="o">=</span> <span class="n">ircfg</span><span class="o">.</span><span class="n">get_block</span><span class="p">(</span><span class="n">current_loc_key</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">assignblk_index</span><span class="p">,</span> <span class="n">assignblk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">current_block</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">assignblk</span><span class="o">.</span><span class="n">instr</span><span class="o">.</span><span class="n">offset</span> <span class="o">==</span> <span class="n">instr_addr</span><span class="p">:</span>
                        <span class="k">break</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># If the function graph does not contain the instruction or the disassembler cannot complete the</span>
                <span class="c1"># task due to unimplemented instructions next(iter(...)) raises a fatal exception</span>
                <span class="c1"># print(e)</span>
                <span class="c1"># traceback.print_exc()</span>
                <span class="k">continue</span>

            <span class="c1"># Recreate default CPU config registers state and general registers to look for</span>
            <span class="n">bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bits</span>
            <span class="n">gp_registers</span> <span class="o">=</span> <span class="p">[</span><span class="n">ExprId</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">bits</span><span class="p">)</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;gpr&quot;</span><span class="p">]]</span>
            <span class="n">init_ctx</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">ExprId</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">bits</span><span class="p">):</span> <span class="n">ExprInt</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">bits</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">registers_values</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>

            <span class="c1"># Generate solutions</span>
            <span class="n">loops</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">sol_nb</span><span class="p">,</span> <span class="n">sol</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                <span class="n">dg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current_block</span><span class="o">.</span><span class="n">loc_key</span><span class="p">,</span> <span class="n">gp_registers</span><span class="p">,</span> <span class="n">assignblk_index</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
            <span class="p">):</span>
                <span class="c1"># The solution contains a loop, we permit only a maximum of 10 solutions with loops...</span>
                <span class="k">if</span> <span class="n">sol</span><span class="o">.</span><span class="n">has_loop</span><span class="p">:</span>
                    <span class="n">loops</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">loops</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                        <span class="k">break</span>

                <span class="c1"># Emulate the blocks chain</span>
                <span class="n">results</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">emul</span><span class="p">(</span><span class="n">ir_arch</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">init_ctx</span><span class="p">)</span>

                <span class="c1"># Retrieve the solutions and translate it in a python expression</span>
                <span class="k">for</span> <span class="n">reg_name</span><span class="p">,</span> <span class="n">reg_value_expr</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">translated_expr</span> <span class="o">=</span> <span class="n">py_transl</span><span class="o">.</span><span class="n">from_expr</span><span class="p">(</span><span class="n">reg_value_expr</span><span class="p">)</span>
                        <span class="n">evaluated_expr</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">translated_expr</span><span class="p">)</span>
                        <span class="n">registers_values</span><span class="p">[</span><span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;register&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">evaluated_expr</span><span class="p">)</span>

                    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                        <span class="c1"># The expression depends on another register which can imply that the function is called</span>
                        <span class="c1"># by another one which pass it the value</span>

                        <span class="c1"># using parents function drastically slow down (block?) the analysis (EXPERIMENTAL not used here)</span>
                        <span class="c1"># for f_parent in instr_data[&quot;f_parents&quot;]:</span>
                        <span class="c1">#     instr_deque.append((instr_addr, {&quot;register&quot;: instr_data[&quot;register&quot;],</span>
                        <span class="c1">#                                      &quot;gpr&quot;: instr_data[&quot;gpr&quot;],</span>
                        <span class="c1">#                                      &quot;f_addr&quot;: f_parent,</span>
                        <span class="c1">#                                      &quot;f_parents&quot;: []</span>
                        <span class="c1">#                                     }))</span>

                        <span class="k">continue</span>

                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="c1"># Possible other exceptions due to MIASM incomplete internal implementation</span>
                        <span class="c1"># print(e)</span>
                        <span class="c1"># traceback.print_exc()</span>
                        <span class="k">continue</span>

        <span class="k">del</span> <span class="n">vm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">free_miasm_memory</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">registers_values</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.CPU.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize the CPU</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>params</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the parameters of the CPU</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the CPU</span>

<span class="sd">    Args:</span>
<span class="sd">        params: the parameters of the CPU</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">architecture</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;architecture&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bits</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;bits&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endianness</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;endianness&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">processor_features</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;processor_features&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">registers_values</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;registers_values&quot;</span><span class="p">,</span> <span class="p">{})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.CPU.extract_bits_big" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_bits_big</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extract bits from an entry in big endian</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>entry</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the entry to extract bits from</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>pos</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the position of the bits</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>n</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of bits to extract</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the extracted bits</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">extract_bits_big</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in big endian</span>

<span class="sd">    Args:</span>
<span class="sd">        entry: the entry to extract bits from</span>
<span class="sd">        pos: the position of the bits</span>
<span class="sd">        n: the number of bits to extract</span>

<span class="sd">    Returns:</span>
<span class="sd">        the extracted bits</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">pos</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.CPU.extract_bits_big64" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_bits_big64</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extract bits from an entry in big endian 64 bits</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>entry</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the entry to extract bits from</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>pos</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the position of the bits</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>n</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of bits to extract</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the extracted bits</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">extract_bits_big64</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in big endian 64 bits</span>

<span class="sd">    Args:</span>
<span class="sd">        entry: the entry to extract bits from</span>
<span class="sd">        pos: the position of the bits</span>
<span class="sd">        n: the number of bits to extract</span>

<span class="sd">    Returns:</span>
<span class="sd">        the extracted bits</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">64</span> <span class="o">-</span> <span class="n">pos</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.CPU.extract_bits_little" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_bits_little</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extract bits from an entry in little endian</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>entry</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the entry to extract bits from</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>pos</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the position of the bits</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>n</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of bits to extract</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the extracted bits</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">extract_bits_little</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in little endian</span>

<span class="sd">    Args:</span>
<span class="sd">        entry: the entry to extract bits from</span>
<span class="sd">        pos: the position of the bits</span>
<span class="sd">        n: the number of bits to extract</span>

<span class="sd">    Returns:</span>
<span class="sd">        the extracted bits</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="n">pos</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.CPU.find_registers_values_dataflow" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">find_registers_values_dataflow</span><span class="p">(</span><span class="n">opcodes</span><span class="p">,</span> <span class="n">zero_registers</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Find the dataflow of the registers</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>opcodes</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the opcodes to analyze</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>zero_registers</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the registers to ignore</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>set</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a dictionnary with the dataflow of the registers</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_registers_values_dataflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opcodes</span><span class="p">,</span> <span class="n">zero_registers</span><span class="o">=</span><span class="p">[])</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the dataflow of the registers</span>

<span class="sd">    Args:</span>
<span class="sd">        opcodes: the opcodes to analyze</span>
<span class="sd">        zero_registers: the registers to ignore</span>

<span class="sd">    Returns:</span>
<span class="sd">        a dictionnary with the dataflow of the registers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Miasm require to define a memory() function to access to the underlaying</span>
    <span class="c1"># memory layer during the Python translation</span>
    <span class="c1"># WORKAROUND: memory() does not permit more than 2 args...</span>
    <span class="n">endianness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endianness</span>

    <span class="k">def</span> <span class="nf">memory</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">size</span><span class="p">),</span> <span class="n">endianness</span><span class="p">)</span>

    <span class="n">machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">get_miasm_machine</span><span class="p">()</span>
    <span class="n">vm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">get_miasm_vmmngr</span><span class="p">()</span>
    <span class="n">mdis</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">dis_engine</span><span class="p">(</span>
        <span class="n">bin_stream_vm</span><span class="p">(</span><span class="n">vm</span><span class="p">),</span> <span class="n">dont_dis_nulstart_bloc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc_db</span><span class="o">=</span><span class="n">LocationDB</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="n">ir_arch</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">ira</span><span class="p">(</span><span class="n">mdis</span><span class="o">.</span><span class="n">loc_db</span><span class="p">)</span>
    <span class="n">py_transl</span> <span class="o">=</span> <span class="n">TranslatorPython</span><span class="p">()</span>

    <span class="c1"># Disable MIASM logging</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;asmblock&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">registers_values</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
    <span class="c1"># We use a stack data structure (deque) in order to also manage parent functions (EXPERIMENTAL not implemented here)</span>
    <span class="n">instr_deque</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">addr</span><span class="p">,</span> <span class="n">opcodes</span><span class="p">[</span><span class="n">addr</span><span class="p">])</span> <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="n">opcodes</span><span class="p">])</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">instr_deque</span><span class="p">):</span>
        <span class="n">instr_addr</span><span class="p">,</span> <span class="n">instr_data</span> <span class="o">=</span> <span class="n">instr_deque</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="c1"># Ignore instruction with associated function not found</span>
        <span class="k">if</span> <span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;f_addr&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Do not dataflow instructions with source registers in zero_registers</span>
        <span class="c1"># because contain zero</span>
        <span class="k">if</span> <span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;gpr&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">zero_registers</span><span class="p">:</span>
            <span class="n">registers_values</span><span class="p">[</span><span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;register&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="c1"># Disable disassemble logging for unimplemented opcodes</span>
        <span class="k">with</span> <span class="n">DisableLogs</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Initialize dependency graph machinery</span>
                <span class="n">mdis</span><span class="o">.</span><span class="n">dont_dis</span> <span class="o">=</span> <span class="p">[</span><span class="n">instr_addr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor_features</span><span class="p">[</span><span class="s2">&quot;instr_len&quot;</span><span class="p">]]</span>
                <span class="n">asmcfg</span> <span class="o">=</span> <span class="n">mdis</span><span class="o">.</span><span class="n">dis_multiblock</span><span class="p">(</span><span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;f_addr&quot;</span><span class="p">])</span>
                <span class="n">ircfg</span> <span class="o">=</span> <span class="n">ir_arch</span><span class="o">.</span><span class="n">new_ircfg_from_asmcfg</span><span class="p">(</span><span class="n">asmcfg</span><span class="p">)</span>
                <span class="n">dg</span> <span class="o">=</span> <span class="n">DependencyGraph</span><span class="p">(</span><span class="n">ircfg</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># Disassembler can raises exception if a JMP address is register dependent,</span>
                <span class="c1"># in that case the analysis fails..</span>
                <span class="c1"># print(e)</span>
                <span class="c1"># traceback.print_exc()</span>
                <span class="k">continue</span>

        <span class="c1"># Collect function informations</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">current_loc_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ircfg</span><span class="o">.</span><span class="n">getby_offset</span><span class="p">(</span><span class="n">instr_addr</span><span class="p">)))</span>
            <span class="n">assignblk_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">current_block</span> <span class="o">=</span> <span class="n">ircfg</span><span class="o">.</span><span class="n">get_block</span><span class="p">(</span><span class="n">current_loc_key</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">assignblk_index</span><span class="p">,</span> <span class="n">assignblk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">current_block</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">assignblk</span><span class="o">.</span><span class="n">instr</span><span class="o">.</span><span class="n">offset</span> <span class="o">==</span> <span class="n">instr_addr</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># If the function graph does not contain the instruction or the disassembler cannot complete the</span>
            <span class="c1"># task due to unimplemented instructions next(iter(...)) raises a fatal exception</span>
            <span class="c1"># print(e)</span>
            <span class="c1"># traceback.print_exc()</span>
            <span class="k">continue</span>

        <span class="c1"># Recreate default CPU config registers state and general registers to look for</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bits</span>
        <span class="n">gp_registers</span> <span class="o">=</span> <span class="p">[</span><span class="n">ExprId</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">bits</span><span class="p">)</span> <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;gpr&quot;</span><span class="p">]]</span>
        <span class="n">init_ctx</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">ExprId</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">bits</span><span class="p">):</span> <span class="n">ExprInt</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">bits</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">registers_values</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="c1"># Generate solutions</span>
        <span class="n">loops</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">sol_nb</span><span class="p">,</span> <span class="n">sol</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="n">dg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current_block</span><span class="o">.</span><span class="n">loc_key</span><span class="p">,</span> <span class="n">gp_registers</span><span class="p">,</span> <span class="n">assignblk_index</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
        <span class="p">):</span>
            <span class="c1"># The solution contains a loop, we permit only a maximum of 10 solutions with loops...</span>
            <span class="k">if</span> <span class="n">sol</span><span class="o">.</span><span class="n">has_loop</span><span class="p">:</span>
                <span class="n">loops</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">loops</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="c1"># Emulate the blocks chain</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">emul</span><span class="p">(</span><span class="n">ir_arch</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">init_ctx</span><span class="p">)</span>

            <span class="c1"># Retrieve the solutions and translate it in a python expression</span>
            <span class="k">for</span> <span class="n">reg_name</span><span class="p">,</span> <span class="n">reg_value_expr</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">translated_expr</span> <span class="o">=</span> <span class="n">py_transl</span><span class="o">.</span><span class="n">from_expr</span><span class="p">(</span><span class="n">reg_value_expr</span><span class="p">)</span>
                    <span class="n">evaluated_expr</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">translated_expr</span><span class="p">)</span>
                    <span class="n">registers_values</span><span class="p">[</span><span class="n">instr_data</span><span class="p">[</span><span class="s2">&quot;register&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">evaluated_expr</span><span class="p">)</span>

                <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                    <span class="c1"># The expression depends on another register which can imply that the function is called</span>
                    <span class="c1"># by another one which pass it the value</span>

                    <span class="c1"># using parents function drastically slow down (block?) the analysis (EXPERIMENTAL not used here)</span>
                    <span class="c1"># for f_parent in instr_data[&quot;f_parents&quot;]:</span>
                    <span class="c1">#     instr_deque.append((instr_addr, {&quot;register&quot;: instr_data[&quot;register&quot;],</span>
                    <span class="c1">#                                      &quot;gpr&quot;: instr_data[&quot;gpr&quot;],</span>
                    <span class="c1">#                                      &quot;f_addr&quot;: f_parent,</span>
                    <span class="c1">#                                      &quot;f_parents&quot;: []</span>
                    <span class="c1">#                                     }))</span>

                    <span class="k">continue</span>

                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="c1"># Possible other exceptions due to MIASM incomplete internal implementation</span>
                    <span class="c1"># print(e)</span>
                    <span class="c1"># traceback.print_exc()</span>
                    <span class="k">continue</span>

    <span class="k">del</span> <span class="n">vm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">free_miasm_memory</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">registers_values</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.CPU.from_cpu_config" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_cpu_config</span><span class="p">(</span><span class="n">cpu_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Create a CPU starting from a YAML file descriptor</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>cpu_config</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the YAML file descriptor</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>additional arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a new CPU object</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_cpu_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">cpu_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a CPU starting from a YAML file descriptor</span>

<span class="sd">    Args:</span>
<span class="sd">        cpu_config: the YAML file descriptor</span>
<span class="sd">        **kwargs: additional arguments</span>

<span class="sd">    Returns:</span>
<span class="sd">        a new CPU object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">CPU</span><span class="p">(</span><span class="n">cpu_config</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.CPU.parse_opcode" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_opcode</span><span class="p">(</span><span class="n">buff</span><span class="p">,</span> <span class="n">page_addr</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parse an opcode</p>
<p>Aimed to be overloaded by child classes</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>buff</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the buffer to parse</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>page_addr</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the address of the page</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>offset</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the offset of the opcode</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the parsed opcode</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_opcode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buff</span><span class="p">,</span> <span class="n">page_addr</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse an opcode</span>

<span class="sd">    Aimed to be overloaded by child classes</span>

<span class="sd">    Args:</span>
<span class="sd">        buff: the buffer to parse</span>
<span class="sd">        page_addr: the address of the page</span>
<span class="sd">        offset: the offset of the opcode</span>

<span class="sd">    Returns:</span>
<span class="sd">        the parsed opcode</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.CPU.parse_opcodes_parallel" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_opcodes_parallel</span><span class="p">(</span><span class="n">addresses</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parse opcodes in parallel</p>
<p>Every process sleep a random delay in order to desynchronise access to disk and maximixe the throuput</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>addresses</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the addresses to parse</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>frame_size</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the frame</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>pidx</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the process index</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>additional arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>dictionnary of parsed opcodes</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_opcodes_parallel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addresses</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse opcodes in parallel</span>

<span class="sd">    Every process sleep a random delay in order to desynchronise access to disk and maximixe the throuput</span>

<span class="sd">    Args:</span>
<span class="sd">        addresses: the addresses to parse</span>
<span class="sd">        frame_size: the size of the frame</span>
<span class="sd">        pidx: the process index</span>
<span class="sd">        **kwargs: additional arguments</span>

<span class="sd">    Returns:</span>
<span class="sd">        dictionnary of parsed opcodes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Every process sleep a random delay in order to desincronize access to disk and maximixe the throuput</span>
    <span class="n">sleep</span><span class="p">(</span><span class="n">uniform</span><span class="p">(</span><span class="n">pidx</span><span class="p">,</span> <span class="n">pidx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">1000</span><span class="p">)</span>

    <span class="n">opcodes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">memory</span><span class="p">)</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">reopen</span><span class="p">()</span>

    <span class="c1"># Cicle over every frame</span>
    <span class="n">total_elems</span><span class="p">,</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">addresses</span>
    <span class="k">for</span> <span class="n">frame_addr</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
        <span class="n">iterator</span><span class="p">,</span> <span class="n">position</span><span class="o">=-</span><span class="n">pidx</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">total_elems</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
        <span class="n">frame_buf</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span>
            <span class="n">frame_addr</span><span class="p">,</span> <span class="n">frame_size</span>
        <span class="p">)</span>  <span class="c1"># We parse memory in PAGE_SIZE chunks</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="n">iter_unpack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processor_features</span><span class="p">[</span><span class="s2">&quot;opcode_unpack_fmt&quot;</span><span class="p">],</span> <span class="n">frame_buf</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">opcode</span> <span class="o">=</span> <span class="n">opcode</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">opcodes</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parse_opcode</span><span class="p">(</span>
                    <span class="n">opcode</span><span class="p">,</span> <span class="n">frame_addr</span><span class="p">,</span> <span class="n">idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor_features</span><span class="p">[</span><span class="s2">&quot;instr_len&quot;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">opcodes</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.CPUReg" class="doc doc-heading">
          <code>CPUReg</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Represents a CPU register</p>

            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CPUReg</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a CPU register&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the value is valid for the register</span>

<span class="sd">        Being a valid register is very specific to the architecture, so this function is aimed to be overloaded by child classes</span>

<span class="sd">        Args:</span>
<span class="sd">            value: the value to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the value is valid, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">is_mmu_equivalent_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_reg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the register is equivalent to another register</span>

<span class="sd">        Args:</span>
<span class="sd">            other_reg: the other register to compare</span>

<span class="sd">        See child classes for more details</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hash of the contained value from register&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.CPUReg.__hash__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__hash__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Hash of the contained value from register</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hash of the contained value from register&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.CPUReg.is_mmu_equivalent_to" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_mmu_equivalent_to</span><span class="p">(</span><span class="n">other_reg</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if the register is equivalent to another register</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>other_reg</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the other register to compare</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>See child classes for more details</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_mmu_equivalent_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_reg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the register is equivalent to another register</span>

<span class="sd">    Args:</span>
<span class="sd">        other_reg: the other register to compare</span>

<span class="sd">    See child classes for more details</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.CPUReg.is_valid" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_valid</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if the value is valid for the register</p>
<p>Being a valid register is very specific to the architecture, so this function is aimed to be overloaded by child classes</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>value</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the value to check</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if the value is valid, False otherwise</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the value is valid for the register</span>

<span class="sd">    Being a valid register is very specific to the architecture, so this function is aimed to be overloaded by child classes</span>

<span class="sd">    Args:</span>
<span class="sd">        value: the value to check</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the value is valid, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.MMU" class="doc doc-heading">
          <code>MMU</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Represents a generic MMU</p>
<p>The MMU is the hardware device that converts the virtual addresses used by the processor to physical addresses.
To accomplish this task, the MMU needs to be configured by using special system registers, while in-memory
structures that maintain the virtual-to-physical mapping have to be defined and continuously updated by the
operating system.
When the MMU fails to resolve a requested virtual address, it raises an interrupt to signal the OS to update
the in-memory related structures.
It is important to note that the MMU demands strict conformity of the shape and topology of the in-memory structure
to the ISA and MMU configuration requirements. Otherwise, it raises an exception and aborts the address translation.
The translation process can involve up to two separate translations, both accomplished by the MMU: segmentation,
which converts virtual to segmented addresses, and paging, which converts segmented addresses to physical ones.
Some architectures use either one or the other, while others use both.
In general, when the system boots, the MMU is virtually disabled and all the virtual addresses are identically
transformed to physical ones. This allows the OS to start in a simplified memory environment and gives it time to
properly configure and enable the MMU before spawning other processes.
Since address translation is a performance bottleneck, the latest translated addresses are cached in a few but low-
latency hardware structures called Translation Lookaside Buffers (TLBs). Before starting a translation, the MMU checks
if TLBs contain an already resolved virtual address and, if so, it returns directly the corresponding physical addresses.</p>
<p>Aimed to be inherited by child classes to represent different architectures</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.mmu_config">mmu_config</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the configuration of the MMU</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.PAGE_SIZE">PAGE_SIZE</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the page</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.extract_bits">extract_bits</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the function to extract bits</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.paging_unpack_format">paging_unpack_format</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the format of the paging</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.page_table_class">page_table_class</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the class of the page table</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.radix_levels">radix_levels</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the levels of the radix tree</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.top_prefix">top_prefix</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the top prefix of the radix tree</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.entries_size">entries_size</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the entries</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.map_ptr_entries_to_levels">map_ptr_entries_to_levels</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between pointer entries and levels</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.map_datapages_entries_to_levels">map_datapages_entries_to_levels</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between data pages entries and levels</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.map_level_to_table_size">map_level_to_table_size</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between levels and table sizes</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.map_entries_to_shifts">map_entries_to_shifts</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between entries and shifts</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.map_reserved_entries_to_levels">map_reserved_entries_to_levels</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between reserved entries and levels</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMU.machine">machine</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the machine of the MMU</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MMU</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a generic MMU</span>

<span class="sd">    The MMU is the hardware device that converts the virtual addresses used by the processor to physical addresses.</span>
<span class="sd">    To accomplish this task, the MMU needs to be configured by using special system registers, while in-memory</span>
<span class="sd">    structures that maintain the virtual-to-physical mapping have to be defined and continuously updated by the</span>
<span class="sd">    operating system.</span>
<span class="sd">    When the MMU fails to resolve a requested virtual address, it raises an interrupt to signal the OS to update</span>
<span class="sd">    the in-memory related structures.</span>
<span class="sd">    It is important to note that the MMU demands strict conformity of the shape and topology of the in-memory structure</span>
<span class="sd">    to the ISA and MMU configuration requirements. Otherwise, it raises an exception and aborts the address translation.</span>
<span class="sd">    The translation process can involve up to two separate translations, both accomplished by the MMU: segmentation,</span>
<span class="sd">    which converts virtual to segmented addresses, and paging, which converts segmented addresses to physical ones.</span>
<span class="sd">    Some architectures use either one or the other, while others use both.</span>
<span class="sd">    In general, when the system boots, the MMU is virtually disabled and all the virtual addresses are identically</span>
<span class="sd">    transformed to physical ones. This allows the OS to start in a simplified memory environment and gives it time to</span>
<span class="sd">    properly configure and enable the MMU before spawning other processes.</span>
<span class="sd">    Since address translation is a performance bottleneck, the latest translated addresses are cached in a few but low-</span>
<span class="sd">    latency hardware structures called Translation Lookaside Buffers (TLBs). Before starting a translation, the MMU checks</span>
<span class="sd">    if TLBs contain an already resolved virtual address and, if so, it returns directly the corresponding physical addresses.</span>

<span class="sd">    Aimed to be inherited by child classes to represent different architectures</span>

<span class="sd">    Attributes:</span>
<span class="sd">        mmu_config: the configuration of the MMU</span>
<span class="sd">        PAGE_SIZE: the size of the page</span>
<span class="sd">        extract_bits: the function to extract bits</span>
<span class="sd">        paging_unpack_format: the format of the paging</span>
<span class="sd">        page_table_class: the class of the page table</span>
<span class="sd">        radix_levels: the levels of the radix tree</span>
<span class="sd">        top_prefix: the top prefix of the radix tree</span>
<span class="sd">        entries_size: the size of the entries</span>
<span class="sd">        map_ptr_entries_to_levels: the mapping between pointer entries and levels</span>
<span class="sd">        map_datapages_entries_to_levels: the mapping between data pages entries and levels</span>
<span class="sd">        map_level_to_table_size: the mapping between levels and table sizes</span>
<span class="sd">        map_entries_to_shifts: the mapping between entries and shifts</span>
<span class="sd">        map_reserved_entries_to_levels: the mapping between reserved entries and levels</span>
<span class="sd">        machine: the machine of the MMU</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">machine</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mmu_config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MMU</span>

<span class="sd">        Args:</span>
<span class="sd">            mmu_config: the configuration of the MMU</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mmu_config</span> <span class="o">=</span> <span class="n">mmu_config</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extract_bits_little</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in little endian</span>

<span class="sd">        Args:</span>
<span class="sd">            entry: the entry to extract bits from</span>
<span class="sd">            pos: the position of the bits</span>
<span class="sd">            n: the number of bits to extract</span>

<span class="sd">        Returns:</span>
<span class="sd">            the extracted bits</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="n">pos</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extract_bits_big</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in big endian</span>

<span class="sd">        Args:</span>
<span class="sd">            entry: the entry to extract bits from</span>
<span class="sd">            pos: the position of the bits</span>
<span class="sd">            n: the number of bits to extract</span>

<span class="sd">        Returns:</span>
<span class="sd">            the extracted bits</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">pos</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extract_bits_big64</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in big endian 64 bits</span>

<span class="sd">        Args:</span>
<span class="sd">            entry: the entry to extract bits from</span>
<span class="sd">            pos: the position of the bits</span>
<span class="sd">            n: the number of bits to extract</span>

<span class="sd">        Returns:</span>
<span class="sd">            the extracted bits</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">64</span> <span class="o">-</span> <span class="n">pos</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMU.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">mmu_config</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize the MMU</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>mmu_config</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the configuration of the MMU</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mmu_config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the MMU</span>

<span class="sd">    Args:</span>
<span class="sd">        mmu_config: the configuration of the MMU</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mmu_config</span> <span class="o">=</span> <span class="n">mmu_config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMU.extract_bits_big" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_bits_big</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extract bits from an entry in big endian</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>entry</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the entry to extract bits from</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>pos</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the position of the bits</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>n</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of bits to extract</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the extracted bits</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">extract_bits_big</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in big endian</span>

<span class="sd">    Args:</span>
<span class="sd">        entry: the entry to extract bits from</span>
<span class="sd">        pos: the position of the bits</span>
<span class="sd">        n: the number of bits to extract</span>

<span class="sd">    Returns:</span>
<span class="sd">        the extracted bits</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">pos</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMU.extract_bits_big64" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_bits_big64</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extract bits from an entry in big endian 64 bits</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>entry</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the entry to extract bits from</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>pos</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the position of the bits</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>n</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of bits to extract</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the extracted bits</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">extract_bits_big64</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in big endian 64 bits</span>

<span class="sd">    Args:</span>
<span class="sd">        entry: the entry to extract bits from</span>
<span class="sd">        pos: the position of the bits</span>
<span class="sd">        n: the number of bits to extract</span>

<span class="sd">    Returns:</span>
<span class="sd">        the extracted bits</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">64</span> <span class="o">-</span> <span class="n">pos</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMU.extract_bits_little" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_bits_little</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extract bits from an entry in little endian</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>entry</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the entry to extract bits from</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>pos</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the position of the bits</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>n</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of bits to extract</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the extracted bits</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">extract_bits_little</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract bits from an entry in little endian</span>

<span class="sd">    Args:</span>
<span class="sd">        entry: the entry to extract bits from</span>
<span class="sd">        pos: the position of the bits</span>
<span class="sd">        n: the number of bits to extract</span>

<span class="sd">    Returns:</span>
<span class="sd">        the extracted bits</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span> <span class="o">&gt;&gt;</span> <span class="n">pos</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.MMURadix" class="doc doc-heading">
          <code>MMURadix</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="mmushell.architectures.generic.MMU" href="#mmushell.architectures.generic.MMU">MMU</a></code></p>

  
      <p>Represents a MMU that uses a Radix Tree</p>
<p>Aimed to be inherited by child classes to represent different architectures</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.PAGE_SIZE">PAGE_SIZE</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the page</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.extract_bits">extract_bits</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the function to extract bits</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.paging_unpack_format">paging_unpack_format</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the format of the paging</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.page_table_class">page_table_class</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the class of the page table</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.radix_levels">radix_levels</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the levels of the radix tree</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.top_prefix">top_prefix</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the top prefix of the radix tree</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.entries_size">entries_size</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the entries</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.map_ptr_entries_to_levels">map_ptr_entries_to_levels</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between pointer entries and levels</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.map_datapages_entries_to_levels">map_datapages_entries_to_levels</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between data pages entries and levels</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.map_level_to_table_size">map_level_to_table_size</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between levels and table sizes</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.map_entries_to_shifts">map_entries_to_shifts</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between entries and shifts</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.MMURadix.map_reserved_entries_to_levels">map_reserved_entries_to_levels</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mapping between reserved entries and levels</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MMURadix</span><span class="p">(</span><span class="n">MMU</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a MMU that uses a Radix Tree</span>

<span class="sd">    Aimed to be inherited by child classes to represent different architectures</span>

<span class="sd">    Attributes:</span>
<span class="sd">        PAGE_SIZE: the size of the page</span>
<span class="sd">        extract_bits: the function to extract bits</span>
<span class="sd">        paging_unpack_format: the format of the paging</span>
<span class="sd">        page_table_class: the class of the page table</span>
<span class="sd">        radix_levels: the levels of the radix tree</span>
<span class="sd">        top_prefix: the top prefix of the radix tree</span>
<span class="sd">        entries_size: the size of the entries</span>
<span class="sd">        map_ptr_entries_to_levels: the mapping between pointer entries and levels</span>
<span class="sd">        map_datapages_entries_to_levels: the mapping between data pages entries and levels</span>
<span class="sd">        map_level_to_table_size: the mapping between levels and table sizes</span>
<span class="sd">        map_entries_to_shifts: the mapping between entries and shifts</span>
<span class="sd">        map_reserved_entries_to_levels: the mapping between reserved entries and levels</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">PAGE_SIZE</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">extract_bits</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">paging_unpack_format</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">page_table_class</span> <span class="o">=</span> <span class="n">PageTable</span>
    <span class="n">radix_levels</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">top_prefix</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">entries_size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">map_ptr_entries_to_levels</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">map_datapages_entries_to_levels</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">map_level_to_table_size</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">map_entries_to_shifts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">map_reserved_entries_to_levels</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">classify_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page_addr</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Classify an entry</span>

<span class="sd">        Aimed to be overloaded by child classes</span>

<span class="sd">        Args:</span>
<span class="sd">            page_addr: the address of the page</span>
<span class="sd">            entry: the entry to classify</span>

<span class="sd">        Returns:</span>
<span class="sd">            the classified entry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">derive_page_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Derive the addresses of pages containing the address</span>

<span class="sd">        Args:</span>
<span class="sd">            addr: the address to derive</span>
<span class="sd">            mode: the mode to use</span>

<span class="sd">        Returns:</span>
<span class="sd">            the addresses of pages containing the address</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">addrs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">lvl</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radix_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">entry_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_datapages_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">entry_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_entries_to_shifts</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">entry_class</span><span class="p">]</span>
                    <span class="n">addrs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">lvl</span><span class="p">,</span> <span class="p">(</span><span class="n">addr</span> <span class="o">&gt;&gt;</span> <span class="n">shift</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">addrs</span>

    <span class="k">def</span> <span class="nf">parse_parallel_frame</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">addresses</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse a frame in parallel</span>

<span class="sd">        Every process sleep a random delay in order to desynchronise access to disk and maximixe the throuput</span>

<span class="sd">        Args:</span>
<span class="sd">            addresses: the addresses to parse</span>
<span class="sd">            frame_size: the size of the frame</span>
<span class="sd">            pidx: the process index</span>
<span class="sd">            mode: the mode to use</span>
<span class="sd">            **kwargs: additional arguments</span>

<span class="sd">        Returns:</span>
<span class="sd">            a tuple containing page tables, data pages and empty tables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Every process sleep a random delay in order to desynchronise access to disk and maximixe the throuput</span>
        <span class="n">sleep</span><span class="p">(</span><span class="n">uniform</span><span class="p">(</span><span class="n">pidx</span><span class="p">,</span> <span class="n">pidx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">1000</span><span class="p">)</span>

        <span class="n">data_pages</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">empty_tables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">page_tables</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radix_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">])]</span>
        <span class="n">mm</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">memory</span><span class="p">)</span>
        <span class="n">mm</span><span class="o">.</span><span class="n">reopen</span><span class="p">()</span>

        <span class="c1"># Cicle over every frame</span>
        <span class="n">total_elems</span><span class="p">,</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">addresses</span>
        <span class="k">for</span> <span class="n">frame_addr</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
            <span class="n">iterator</span><span class="p">,</span> <span class="n">position</span><span class="o">=-</span><span class="n">pidx</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">total_elems</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">):</span>
            <span class="n">frame_buf</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">frame_addr</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">)</span>
            <span class="n">invalids</span><span class="p">,</span> <span class="n">pt_classes</span><span class="p">,</span> <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_frame</span><span class="p">(</span>
                <span class="n">frame_buf</span><span class="p">,</span> <span class="n">frame_addr</span><span class="p">,</span> <span class="n">frame_size</span>
            <span class="p">)</span>

            <span class="c1"># It is a data page</span>
            <span class="k">if</span> <span class="n">invalids</span> <span class="ow">or</span> <span class="o">-</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">pt_classes</span><span class="p">:</span>
                <span class="n">data_pages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame_addr</span><span class="p">)</span>
            <span class="k">elif</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">pt_classes</span><span class="p">:</span>
                <span class="n">empty_tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame_addr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">pt_class</span> <span class="ow">in</span> <span class="n">pt_classes</span><span class="p">:</span>
                    <span class="n">page_tables</span><span class="p">[</span><span class="n">pt_class</span><span class="p">][</span><span class="n">frame_addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_obj</span>

        <span class="k">return</span> <span class="n">page_tables</span><span class="p">,</span> <span class="n">data_pages</span><span class="p">,</span> <span class="n">empty_tables</span>

    <span class="k">def</span> <span class="nf">parse_frame</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">frame_buf</span><span class="p">,</span> <span class="n">frame_addr</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">frame_level</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse a frame</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_buf: the buffer of the frame</span>
<span class="sd">            frame_addr: the address of the frame</span>
<span class="sd">            frame_size: the size of the frame</span>
<span class="sd">            frame_level: the level of the frame</span>
<span class="sd">            mode: the mode to use</span>

<span class="sd">        Returns:</span>
<span class="sd">            a tuple containing the number of invalids, the classes of the page tables and page table object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frame_d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">frame_level</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">reseved_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_reserved_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span>
                <span class="n">frame_level</span>
            <span class="p">]</span>
            <span class="n">data_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_datapages_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span>
                <span class="n">frame_level</span>
            <span class="p">]</span>
            <span class="n">ptr_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_ptr_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">frame_level</span><span class="p">]</span>
            <span class="c1"># frame_size = self.machine.mmu.map_level_to_table_size[mode][frame_level]</span>

        <span class="n">invalids</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">empty_entries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Unpack records inside the frame</span>
        <span class="k">for</span> <span class="n">entry_idx</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="n">iter_unpack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paging_unpack_format</span><span class="p">,</span> <span class="n">frame_buf</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">frame_level</span> <span class="o">&gt;=</span> <span class="mi">0</span>
                <span class="ow">and</span> <span class="n">entry_idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">entries_size</span> <span class="o">&gt;=</span> <span class="n">frame_size</span>
            <span class="p">):</span>
                <span class="k">break</span>

            <span class="n">entry</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># Classify the entry</span>
            <span class="n">entry_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify_entry</span><span class="p">(</span><span class="n">frame_addr</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
            <span class="c1"># It&#39;s a data page</span>
            <span class="k">if</span> <span class="n">entry_classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">frame_level</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">invalids</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="c1"># It&#39;s an empty page (data page or page table)</span>
            <span class="k">if</span> <span class="n">entry_classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">empty_entries</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>

            <span class="c1"># Add all records if scanning the memory or only the record of a particular level if it is creating a table to be print</span>
            <span class="k">if</span> <span class="n">frame_level</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">entry_obj</span> <span class="ow">in</span> <span class="n">entry_classes</span><span class="p">:</span>
                    <span class="n">entry_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry_obj</span><span class="p">)</span>
                    <span class="n">frame_d</span><span class="p">[</span><span class="n">entry_type</span><span class="p">][</span><span class="n">entry_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_obj</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">entry_obj</span> <span class="ow">in</span> <span class="n">entry_classes</span><span class="p">:</span>
                    <span class="n">entry_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry_obj</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="nb">type</span><span class="p">(</span><span class="n">entry_obj</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_classes</span>
                        <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry_obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">ptr_class</span>
                        <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry_obj</span><span class="p">)</span> <span class="ow">in</span> <span class="n">reseved_classes</span>
                    <span class="p">):</span>
                        <span class="n">frame_d</span><span class="p">[</span><span class="n">entry_type</span><span class="p">][</span><span class="n">entry_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_obj</span>
                        <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">invalids</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Classify the frame</span>
        <span class="n">pt_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify_frame</span><span class="p">(</span>
            <span class="n">frame_d</span><span class="p">,</span>
            <span class="n">empty_entries</span><span class="p">,</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">frame_size</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_table_class</span><span class="o">.</span><span class="n">entry_size</span><span class="p">),</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">pt_classes</span> <span class="ow">or</span> <span class="o">-</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">pt_classes</span><span class="p">:</span>  <span class="c1"># EMPTY or DATA</span>
            <span class="n">table_obj</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_table_class</span><span class="p">(</span>
                <span class="n">frame_addr</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">frame_d</span><span class="p">,</span> <span class="n">pt_classes</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">invalids</span><span class="p">,</span> <span class="n">pt_classes</span><span class="p">,</span> <span class="n">table_obj</span>

    <span class="k">def</span> <span class="nf">classify_frame</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">frame_d</span><span class="p">,</span>
        <span class="n">empty_c</span><span class="p">,</span>
        <span class="n">entries_per_frame</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Classify a frame</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_d: the buffer of the frame</span>
<span class="sd">            empty_c: the number of empty entries</span>
<span class="sd">            entries_per_frame: the number of entries per frame</span>
<span class="sd">            mode: the mode to use</span>

<span class="sd">        Returns:</span>
<span class="sd">            a list containing the classes of the page tables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">empty_c</span> <span class="o">==</span> <span class="n">entries_per_frame</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># EMPTY</span>

        <span class="c1"># For each level check if a table is a valid candidate</span>
        <span class="n">frame_classes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radix_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">]):</span>
            <span class="n">entries</span> <span class="o">=</span> <span class="n">empty_c</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_ptr_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">level</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">entries</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frame_d</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">map_ptr_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">level</span><span class="p">]])</span>
            <span class="k">for</span> <span class="n">data_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_datapages_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">level</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">data_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">entries</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frame_d</span><span class="p">[</span><span class="n">data_class</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">reserved_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_reserved_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">level</span><span class="p">]:</span>
                <span class="n">entries</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frame_d</span><span class="p">[</span><span class="n">reserved_class</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">entries</span> <span class="o">==</span> <span class="n">entries_per_frame</span><span class="p">:</span>
                <span class="n">frame_classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">frame_classes</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># DATA</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">frame_classes</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMURadix.classify_entry" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">classify_entry</span><span class="p">(</span><span class="n">page_addr</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Classify an entry</p>
<p>Aimed to be overloaded by child classes</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>page_addr</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the address of the page</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>entry</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the entry to classify</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the classified entry</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">classify_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page_addr</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classify an entry</span>

<span class="sd">    Aimed to be overloaded by child classes</span>

<span class="sd">    Args:</span>
<span class="sd">        page_addr: the address of the page</span>
<span class="sd">        entry: the entry to classify</span>

<span class="sd">    Returns:</span>
<span class="sd">        the classified entry</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMURadix.classify_frame" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">classify_frame</span><span class="p">(</span><span class="n">frame_d</span><span class="p">,</span> <span class="n">empty_c</span><span class="p">,</span> <span class="n">entries_per_frame</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Classify a frame</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>frame_d</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the buffer of the frame</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>empty_c</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of empty entries</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>entries_per_frame</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of entries per frame</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>mode</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mode to use</p>
            </div>
          </td>
          <td>
                <code>&#39;global&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a list containing the classes of the page tables</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">classify_frame</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">frame_d</span><span class="p">,</span>
    <span class="n">empty_c</span><span class="p">,</span>
    <span class="n">entries_per_frame</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classify a frame</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_d: the buffer of the frame</span>
<span class="sd">        empty_c: the number of empty entries</span>
<span class="sd">        entries_per_frame: the number of entries per frame</span>
<span class="sd">        mode: the mode to use</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list containing the classes of the page tables</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">empty_c</span> <span class="o">==</span> <span class="n">entries_per_frame</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># EMPTY</span>

    <span class="c1"># For each level check if a table is a valid candidate</span>
    <span class="n">frame_classes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radix_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">]):</span>
        <span class="n">entries</span> <span class="o">=</span> <span class="n">empty_c</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_ptr_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">level</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">entries</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frame_d</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">map_ptr_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">level</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">data_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_datapages_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">level</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">data_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">entries</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frame_d</span><span class="p">[</span><span class="n">data_class</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">reserved_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_reserved_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">level</span><span class="p">]:</span>
            <span class="n">entries</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frame_d</span><span class="p">[</span><span class="n">reserved_class</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">entries</span> <span class="o">==</span> <span class="n">entries_per_frame</span><span class="p">:</span>
            <span class="n">frame_classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">frame_classes</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># DATA</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">frame_classes</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMURadix.derive_page_address" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">derive_page_address</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Derive the addresses of pages containing the address</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>addr</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the address to derive</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>mode</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mode to use</p>
            </div>
          </td>
          <td>
                <code>&#39;global&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the addresses of pages containing the address</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">derive_page_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Derive the addresses of pages containing the address</span>

<span class="sd">    Args:</span>
<span class="sd">        addr: the address to derive</span>
<span class="sd">        mode: the mode to use</span>

<span class="sd">    Returns:</span>
<span class="sd">        the addresses of pages containing the address</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">addrs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">lvl</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radix_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">entry_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_datapages_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">entry_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_entries_to_shifts</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">entry_class</span><span class="p">]</span>
                <span class="n">addrs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">lvl</span><span class="p">,</span> <span class="p">(</span><span class="n">addr</span> <span class="o">&gt;&gt;</span> <span class="n">shift</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">addrs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMURadix.parse_frame" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_frame</span><span class="p">(</span><span class="n">frame_buf</span><span class="p">,</span> <span class="n">frame_addr</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">frame_level</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parse a frame</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>frame_buf</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the buffer of the frame</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>frame_addr</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the address of the frame</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>frame_size</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the frame</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>frame_level</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the level of the frame</p>
            </div>
          </td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>mode</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mode to use</p>
            </div>
          </td>
          <td>
                <code>&#39;global&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a tuple containing the number of invalids, the classes of the page tables and page table object</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_frame</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">frame_buf</span><span class="p">,</span> <span class="n">frame_addr</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">frame_level</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a frame</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_buf: the buffer of the frame</span>
<span class="sd">        frame_addr: the address of the frame</span>
<span class="sd">        frame_size: the size of the frame</span>
<span class="sd">        frame_level: the level of the frame</span>
<span class="sd">        mode: the mode to use</span>

<span class="sd">    Returns:</span>
<span class="sd">        a tuple containing the number of invalids, the classes of the page tables and page table object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">frame_d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">frame_level</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">reseved_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_reserved_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span>
            <span class="n">frame_level</span>
        <span class="p">]</span>
        <span class="n">data_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_datapages_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span>
            <span class="n">frame_level</span>
        <span class="p">]</span>
        <span class="n">ptr_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_ptr_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">frame_level</span><span class="p">]</span>
        <span class="c1"># frame_size = self.machine.mmu.map_level_to_table_size[mode][frame_level]</span>

    <span class="n">invalids</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">empty_entries</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Unpack records inside the frame</span>
    <span class="k">for</span> <span class="n">entry_idx</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
        <span class="n">iter_unpack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paging_unpack_format</span><span class="p">,</span> <span class="n">frame_buf</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">frame_level</span> <span class="o">&gt;=</span> <span class="mi">0</span>
            <span class="ow">and</span> <span class="n">entry_idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">entries_size</span> <span class="o">&gt;=</span> <span class="n">frame_size</span>
        <span class="p">):</span>
            <span class="k">break</span>

        <span class="n">entry</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Classify the entry</span>
        <span class="n">entry_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify_entry</span><span class="p">(</span><span class="n">frame_addr</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span>
        <span class="c1"># It&#39;s a data page</span>
        <span class="k">if</span> <span class="n">entry_classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">frame_level</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">invalids</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># It&#39;s an empty page (data page or page table)</span>
        <span class="k">if</span> <span class="n">entry_classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">empty_entries</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>

        <span class="c1"># Add all records if scanning the memory or only the record of a particular level if it is creating a table to be print</span>
        <span class="k">if</span> <span class="n">frame_level</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry_obj</span> <span class="ow">in</span> <span class="n">entry_classes</span><span class="p">:</span>
                <span class="n">entry_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry_obj</span><span class="p">)</span>
                <span class="n">frame_d</span><span class="p">[</span><span class="n">entry_type</span><span class="p">][</span><span class="n">entry_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry_obj</span> <span class="ow">in</span> <span class="n">entry_classes</span><span class="p">:</span>
                <span class="n">entry_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry_obj</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="nb">type</span><span class="p">(</span><span class="n">entry_obj</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_classes</span>
                    <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry_obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">ptr_class</span>
                    <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry_obj</span><span class="p">)</span> <span class="ow">in</span> <span class="n">reseved_classes</span>
                <span class="p">):</span>
                    <span class="n">frame_d</span><span class="p">[</span><span class="n">entry_type</span><span class="p">][</span><span class="n">entry_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_obj</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">invalids</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Classify the frame</span>
    <span class="n">pt_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify_frame</span><span class="p">(</span>
        <span class="n">frame_d</span><span class="p">,</span>
        <span class="n">empty_entries</span><span class="p">,</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">frame_size</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_table_class</span><span class="o">.</span><span class="n">entry_size</span><span class="p">),</span>
        <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">pt_classes</span> <span class="ow">or</span> <span class="o">-</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">pt_classes</span><span class="p">:</span>  <span class="c1"># EMPTY or DATA</span>
        <span class="n">table_obj</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_table_class</span><span class="p">(</span>
            <span class="n">frame_addr</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">frame_d</span><span class="p">,</span> <span class="n">pt_classes</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">invalids</span><span class="p">,</span> <span class="n">pt_classes</span><span class="p">,</span> <span class="n">table_obj</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMURadix.parse_parallel_frame" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_parallel_frame</span><span class="p">(</span><span class="n">addresses</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parse a frame in parallel</p>
<p>Every process sleep a random delay in order to desynchronise access to disk and maximixe the throuput</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>addresses</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the addresses to parse</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>frame_size</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the frame</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>pidx</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the process index</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>mode</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the mode to use</p>
            </div>
          </td>
          <td>
                <code>&#39;global&#39;</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>additional arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a tuple containing page tables, data pages and empty tables</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_parallel_frame</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">addresses</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a frame in parallel</span>

<span class="sd">    Every process sleep a random delay in order to desynchronise access to disk and maximixe the throuput</span>

<span class="sd">    Args:</span>
<span class="sd">        addresses: the addresses to parse</span>
<span class="sd">        frame_size: the size of the frame</span>
<span class="sd">        pidx: the process index</span>
<span class="sd">        mode: the mode to use</span>
<span class="sd">        **kwargs: additional arguments</span>

<span class="sd">    Returns:</span>
<span class="sd">        a tuple containing page tables, data pages and empty tables</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Every process sleep a random delay in order to desynchronise access to disk and maximixe the throuput</span>
    <span class="n">sleep</span><span class="p">(</span><span class="n">uniform</span><span class="p">(</span><span class="n">pidx</span><span class="p">,</span> <span class="n">pidx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">1000</span><span class="p">)</span>

    <span class="n">data_pages</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">empty_tables</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">page_tables</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radix_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">])]</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">memory</span><span class="p">)</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">reopen</span><span class="p">()</span>

    <span class="c1"># Cicle over every frame</span>
    <span class="n">total_elems</span><span class="p">,</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">addresses</span>
    <span class="k">for</span> <span class="n">frame_addr</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
        <span class="n">iterator</span><span class="p">,</span> <span class="n">position</span><span class="o">=-</span><span class="n">pidx</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">total_elems</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
        <span class="n">frame_buf</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">frame_addr</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">)</span>
        <span class="n">invalids</span><span class="p">,</span> <span class="n">pt_classes</span><span class="p">,</span> <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_frame</span><span class="p">(</span>
            <span class="n">frame_buf</span><span class="p">,</span> <span class="n">frame_addr</span><span class="p">,</span> <span class="n">frame_size</span>
        <span class="p">)</span>

        <span class="c1"># It is a data page</span>
        <span class="k">if</span> <span class="n">invalids</span> <span class="ow">or</span> <span class="o">-</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">pt_classes</span><span class="p">:</span>
            <span class="n">data_pages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame_addr</span><span class="p">)</span>
        <span class="k">elif</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">pt_classes</span><span class="p">:</span>
            <span class="n">empty_tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame_addr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pt_class</span> <span class="ow">in</span> <span class="n">pt_classes</span><span class="p">:</span>
                <span class="n">page_tables</span><span class="p">[</span><span class="n">pt_class</span><span class="p">][</span><span class="n">frame_addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_obj</span>

    <span class="k">return</span> <span class="n">page_tables</span><span class="p">,</span> <span class="n">data_pages</span><span class="p">,</span> <span class="n">empty_tables</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.MMUShell" class="doc doc-heading">
          <code>MMUShell</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="cmd.Cmd">Cmd</span></code></p>


            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MMUShell</span><span class="p">(</span><span class="n">Cmd</span><span class="p">):</span>
    <span class="n">intro</span> <span class="o">=</span> <span class="s2">&quot;MMUShell.   Type help or ? to list commands.</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">completekey</span><span class="o">=</span><span class="s2">&quot;tab&quot;</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">machine</span><span class="o">=</span><span class="p">{}):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MMUShell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">completekey</span><span class="p">,</span> <span class="n">stdin</span><span class="p">,</span> <span class="n">stdout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">machine</span> <span class="o">=</span> <span class="n">machine</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;[MMUShell &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">cpu</span><span class="o">.</span><span class="n">architecture</span> <span class="o">+</span> <span class="s2">&quot;]# &quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gtruth</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">reload_data_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_filename</span><span class="p">):</span>
        <span class="c1"># Load a previous session</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading previous session data...&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">data_filename</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;lzma&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s2">&quot;Fatal error loading session data! Error:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="kn">import</span> <span class="nn">traceback</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">())</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_gtruth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gtruth_fd</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gtruth</span> <span class="o">=</span> <span class="n">Load</span><span class="p">(</span><span class="n">gtruth_fd</span><span class="p">)</span>
            <span class="n">gtruth_fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s2">&quot;Fatal error loading ground truth file! Error:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">do_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Exit :)&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bye! :)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">do_save_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save data in a compressed pickle file&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Use: save_data FILENAME&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Saving data...&quot;</span><span class="p">)</span>
            <span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;lzma&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error in session data. Error: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">return</span>

    <span class="c1"># def do_show_machine_config(self, arg):</span>
    <span class="c1">#     &quot;&quot;&quot;Show the machine configuration&quot;&quot;&quot;</span>
    <span class="c1">#     pprint(self.machine_config)</span>

    <span class="k">def</span> <span class="nf">do_ipython</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an IPython shell&quot;&quot;&quot;</span>
        <span class="n">embed</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">emptyline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">parse_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s2">&quot;0123456789abcdefxABCDEFX&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;0x&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">radix_roots_from_data_page</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">pg_lvl</span><span class="p">,</span> <span class="n">pg_addr</span><span class="p">,</span> <span class="n">rev_map_pages</span><span class="p">,</span> <span class="n">rev_map_tables</span>
    <span class="p">):</span>
        <span class="c1"># For a page address pointed by tables of level &#39;level&#39; find all the radix root of trees containing it</span>

        <span class="n">level_tables</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">prev_level_tables</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># Collect all table at level &#39;pg_lvl&#39; which point to that page</span>
        <span class="n">level_tables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rev_map_pages</span><span class="p">[</span><span class="n">pg_lvl</span><span class="p">][</span><span class="n">pg_addr</span><span class="p">])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;radix_roots_from_data_pages: level_tables found </span><span class="si">{}</span><span class="s2"> for pg_addr </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">level_tables</span><span class="p">),</span> <span class="nb">hex</span><span class="p">(</span><span class="n">pg_addr</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Raise the tree in order to find the top table</span>
        <span class="k">for</span> <span class="n">tree_lvl</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pg_lvl</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">table_addr</span> <span class="ow">in</span> <span class="n">level_tables</span><span class="p">:</span>
                <span class="n">prev_level_tables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rev_map_tables</span><span class="p">[</span><span class="n">tree_lvl</span><span class="p">][</span><span class="n">table_addr</span><span class="p">])</span>

            <span class="n">level_tables</span> <span class="o">=</span> <span class="n">prev_level_tables</span>
            <span class="n">prev_level_tables</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;radix_roots_from_data_pages: level_tables found </span><span class="si">{}</span><span class="s2"> for pg_addr </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">level_tables</span><span class="p">),</span> <span class="nb">hex</span><span class="p">(</span><span class="n">pg_addr</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">level_tables</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">physpace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">addr</span><span class="p">,</span>
        <span class="n">page_tables</span><span class="p">,</span>
        <span class="n">empty_tables</span><span class="p">,</span>
        <span class="n">lvl</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">uperms</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="n">hierarchical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="p">,</span>
        <span class="n">cache</span><span class="o">=</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">),</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively evaluate the consistency and return the kernel/user physical space addressed&quot;&quot;&quot;</span>
        <span class="n">pas</span> <span class="o">=</span> <span class="n">PAS</span><span class="p">()</span>
        <span class="n">data_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_datapages_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">]</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;physpace() radix: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="si">}</span><span class="s2"> Lvl: </span><span class="si">{</span><span class="n">lvl</span><span class="si">}</span><span class="s2"> Table: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Leaf level</span>
        <span class="k">if</span> <span class="n">lvl</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">radix_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">data_class</span> <span class="ow">in</span> <span class="n">data_classes</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">data_class</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">perms</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
                    <span class="n">pas</span><span class="o">.</span><span class="n">space</span><span class="p">[</span><span class="n">perms</span><span class="p">][</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>
                    <span class="n">pas</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perms</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>

            <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">pas</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Superior levels</span>
            <span class="n">ptr_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_ptr_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ptr_class</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">ptr_class</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="p">(</span>
                            <span class="n">entry</span><span class="o">.</span><span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">empty_tables</span>
                        <span class="p">):</span>  <span class="c1"># It is not an empty table!</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;physpace() radix: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="si">}</span><span class="s2"> parent level: </span><span class="si">{</span><span class="n">lvl</span><span class="si">}</span><span class="s2"> table: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="si">}</span><span class="s2"> invalid&quot;</span>
                            <span class="p">)</span>
                            <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
                            <span class="n">low_cons</span><span class="p">,</span> <span class="n">low_pas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">(</span>
                                <span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
                                <span class="n">page_tables</span><span class="p">,</span>
                                <span class="n">empty_tables</span><span class="p">,</span>
                                <span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                <span class="n">uperms</span><span class="o">=</span><span class="n">uperms</span><span class="p">,</span>
                                <span class="n">hierarchical</span><span class="o">=</span><span class="n">hierarchical</span><span class="p">,</span>
                                <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
                                <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span>
                            <span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">low_cons</span><span class="p">,</span> <span class="n">low_pas</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">]</span>

                        <span class="k">if</span> <span class="ow">not</span> <span class="n">low_cons</span><span class="p">:</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;physpace() radix: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="si">}</span><span class="s2"> parent level: </span><span class="si">{</span><span class="n">lvl</span><span class="si">}</span><span class="s2"> table: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="si">}</span><span class="s2"> invalid&quot;</span>
                            <span class="p">)</span>
                            <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span>

                        <span class="k">if</span> <span class="n">hierarchical</span><span class="p">:</span>
                            <span class="n">pas</span><span class="o">.</span><span class="n">hierarchical_extend</span><span class="p">(</span><span class="n">low_pas</span><span class="p">,</span> <span class="n">uperms</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">pas</span><span class="o">.</span><span class="n">hierarchical_extend</span><span class="p">(</span><span class="n">low_pas</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">data_class</span> <span class="ow">in</span> <span class="n">data_classes</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">data_class</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span>
                    <span class="ow">and</span> <span class="n">data_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="p">):</span>
                    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">data_class</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                        <span class="n">perms</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
                        <span class="n">pas</span><span class="o">.</span><span class="n">space</span><span class="p">[</span><span class="n">perms</span><span class="p">][</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>
                        <span class="n">pas</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perms</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>

            <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">pas</span>

    <span class="k">def</span> <span class="nf">resolve_vaddr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cr3</span><span class="p">,</span> <span class="n">vaddr</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="p">):</span>
        <span class="c1"># Return the paddr or -1</span>

        <span class="c1"># Split in possible table resolution paths</span>
        <span class="k">for</span> <span class="n">splitted_addr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">split_vaddr</span><span class="p">(</span><span class="n">vaddr</span><span class="p">):</span>
            <span class="n">current_table_addr</span> <span class="o">=</span> <span class="n">cr3</span>
            <span class="n">requested_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">splitted_addr</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">resolution_steps</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">for</span> <span class="n">level_idx</span><span class="p">,</span> <span class="n">idx_t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">splitted_addr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">level_class</span><span class="p">,</span> <span class="n">entry_idx</span> <span class="o">=</span> <span class="n">idx_t</span>
                <span class="c1"># Missing valid table, no valid resolution path</span>
                <span class="k">if</span> <span class="n">current_table_addr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="s2">&quot;global&quot;</span><span class="p">][</span><span class="n">level_idx</span><span class="p">]:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;resolve_vaddr() Missing table </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">current_table_addr</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;resolve_vaddr() RESOLUTION PATH FAILED! ########&quot;</span><span class="p">)</span>
                    <span class="k">break</span>

                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;resolve_vaddr(): Resolution path Lvl: </span><span class="si">{</span><span class="n">level_class</span><span class="si">}</span><span class="s2"> Table: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">current_table_addr</span><span class="p">)</span><span class="si">}</span><span class="s2"> Entry addr: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="w"> </span><span class="n">current_table_addr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">page_table_class</span><span class="o">.</span><span class="n">entry_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">entry_idx</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="c1"># Find valid entry in table</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">entry_idx</span>
                    <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="s2">&quot;global&quot;</span><span class="p">][</span><span class="n">level_idx</span><span class="p">][</span>
                        <span class="n">current_table_addr</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">level_class</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">current_table_addr</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="s2">&quot;global&quot;</span><span class="p">][</span><span class="n">level_idx</span><span class="p">][</span><span class="n">current_table_addr</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">level_class</span><span class="p">][</span><span class="n">entry_idx</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">address</span>
                    <span class="p">)</span>

                    <span class="n">resolution_steps</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># Each resolution path involves different number of steps (table to walk)</span>
                    <span class="k">if</span> <span class="n">resolution_steps</span> <span class="o">==</span> <span class="n">requested_steps</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">current_table_addr</span> <span class="o">+</span> <span class="n">splitted_addr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;resolve_vaddr() RESOLUTION PATH FAILED! ########&quot;</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">virtspace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">addr</span><span class="p">,</span>
        <span class="n">lvl</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">prefix</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">uperms</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="n">hierarchical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="p">,</span>
        <span class="n">cache</span><span class="o">=</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">),</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursively reconstruct virtual address space&quot;&quot;&quot;</span>

        <span class="n">virtspace</span> <span class="o">=</span> <span class="n">VAS</span><span class="p">()</span>
        <span class="n">data_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_datapages_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">]</span>
        <span class="n">ptr_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_ptr_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">]</span>
        <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">portion</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">lvl</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">radix_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">data_class</span> <span class="ow">in</span> <span class="n">data_classes</span><span class="p">:</span>
                <span class="n">shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_entries_to_shifts</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">data_class</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">entry_idx</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">data_class</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">):</span>
                    <span class="n">permissions</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
                    <span class="n">virt_addr</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">|</span> <span class="p">(</span><span class="n">entry_idx</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">)</span>
                    <span class="n">virtspace</span><span class="p">[</span><span class="n">permissions</span><span class="p">]</span> <span class="o">|=</span> <span class="n">portion</span><span class="o">.</span><span class="n">closedopen</span><span class="p">(</span>
                        <span class="n">virt_addr</span><span class="p">,</span> <span class="n">virt_addr</span> <span class="o">+</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>
                    <span class="p">)</span>

            <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">virtspace</span>
            <span class="k">return</span> <span class="n">virtspace</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ptr_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
                <span class="n">shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_entries_to_shifts</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">ptr_class</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">entry_idx</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">ptr_class</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">):</span>
                    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
                        <span class="k">continue</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">permissions</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>

                        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
                            <span class="n">virt_addr</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">|</span> <span class="p">(</span><span class="n">entry_idx</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">)</span>
                            <span class="n">low_virts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">virtspace</span><span class="p">(</span>
                                <span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
                                <span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                <span class="n">virt_addr</span><span class="p">,</span>
                                <span class="n">permissions</span><span class="p">,</span>
                                <span class="n">hierarchical</span><span class="o">=</span><span class="n">hierarchical</span><span class="p">,</span>
                                <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
                                <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span>
                            <span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">low_virts</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">]</span>

                        <span class="k">if</span> <span class="n">hierarchical</span><span class="p">:</span>
                            <span class="n">virtspace</span><span class="o">.</span><span class="n">hierarchical_extend</span><span class="p">(</span><span class="n">low_virts</span><span class="p">,</span> <span class="n">uperms</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">virtspace</span><span class="o">.</span><span class="n">hierarchical_extend</span><span class="p">(</span><span class="n">low_virts</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">data_class</span> <span class="ow">in</span> <span class="n">data_classes</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">data_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span>
                    <span class="ow">and</span> <span class="n">data_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="p">):</span>
                    <span class="n">shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_entries_to_shifts</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">data_class</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">entry_idx</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">data_class</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="p">):</span>
                        <span class="n">permissions</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
                        <span class="n">virt_addr</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">|</span> <span class="p">(</span><span class="n">entry_idx</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">)</span>
                        <span class="n">virtspace</span><span class="p">[</span><span class="n">permissions</span><span class="p">]</span> <span class="o">|=</span> <span class="n">portion</span><span class="o">.</span><span class="n">closedopen</span><span class="p">(</span>
                            <span class="n">virt_addr</span><span class="p">,</span> <span class="n">virt_addr</span> <span class="o">+</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>
                        <span class="p">)</span>

            <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">virtspace</span>
            <span class="k">return</span> <span class="n">virtspace</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMUShell.do_exit" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">do_exit</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Exit :)</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">do_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exit :)&quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bye! :)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMUShell.do_ipython" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">do_ipython</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Open an IPython shell</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">do_ipython</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open an IPython shell&quot;&quot;&quot;</span>
    <span class="n">embed</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMUShell.do_save_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">do_save_data</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Save data in a compressed pickle file</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">do_save_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save data in a compressed pickle file&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Use: save_data FILENAME&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Saving data...&quot;</span><span class="p">)</span>
        <span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;lzma&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error in session data. Error: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">return</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMUShell.physpace" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">physpace</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">page_tables</span><span class="p">,</span> <span class="n">empty_tables</span><span class="p">,</span> <span class="n">lvl</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">uperms</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">hierarchical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">))</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Recursively evaluate the consistency and return the kernel/user physical space addressed</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">physpace</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">addr</span><span class="p">,</span>
    <span class="n">page_tables</span><span class="p">,</span>
    <span class="n">empty_tables</span><span class="p">,</span>
    <span class="n">lvl</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">uperms</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">hierarchical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="p">,</span>
    <span class="n">cache</span><span class="o">=</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively evaluate the consistency and return the kernel/user physical space addressed&quot;&quot;&quot;</span>
    <span class="n">pas</span> <span class="o">=</span> <span class="n">PAS</span><span class="p">()</span>
    <span class="n">data_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_datapages_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">]</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;physpace() radix: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="si">}</span><span class="s2"> Lvl: </span><span class="si">{</span><span class="n">lvl</span><span class="si">}</span><span class="s2"> Table: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Leaf level</span>
    <span class="k">if</span> <span class="n">lvl</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">radix_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">data_class</span> <span class="ow">in</span> <span class="n">data_classes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">data_class</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">perms</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
                <span class="n">pas</span><span class="o">.</span><span class="n">space</span><span class="p">[</span><span class="n">perms</span><span class="p">][</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>
                <span class="n">pas</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perms</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>

        <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">pas</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Superior levels</span>
        <span class="n">ptr_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_ptr_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ptr_class</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">ptr_class</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">entry</span><span class="o">.</span><span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">empty_tables</span>
                    <span class="p">):</span>  <span class="c1"># It is not an empty table!</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;physpace() radix: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="si">}</span><span class="s2"> parent level: </span><span class="si">{</span><span class="n">lvl</span><span class="si">}</span><span class="s2"> table: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="si">}</span><span class="s2"> invalid&quot;</span>
                        <span class="p">)</span>
                        <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
                        <span class="n">low_cons</span><span class="p">,</span> <span class="n">low_pas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">(</span>
                            <span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
                            <span class="n">page_tables</span><span class="p">,</span>
                            <span class="n">empty_tables</span><span class="p">,</span>
                            <span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="n">uperms</span><span class="o">=</span><span class="n">uperms</span><span class="p">,</span>
                            <span class="n">hierarchical</span><span class="o">=</span><span class="n">hierarchical</span><span class="p">,</span>
                            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
                            <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">low_cons</span><span class="p">,</span> <span class="n">low_pas</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">]</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">low_cons</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;physpace() radix: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="si">}</span><span class="s2"> parent level: </span><span class="si">{</span><span class="n">lvl</span><span class="si">}</span><span class="s2"> table: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="si">}</span><span class="s2"> invalid&quot;</span>
                        <span class="p">)</span>
                        <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span>

                    <span class="k">if</span> <span class="n">hierarchical</span><span class="p">:</span>
                        <span class="n">pas</span><span class="o">.</span><span class="n">hierarchical_extend</span><span class="p">(</span><span class="n">low_pas</span><span class="p">,</span> <span class="n">uperms</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pas</span><span class="o">.</span><span class="n">hierarchical_extend</span><span class="p">(</span><span class="n">low_pas</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">data_class</span> <span class="ow">in</span> <span class="n">data_classes</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">data_class</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span>
                <span class="ow">and</span> <span class="n">data_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">):</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">page_tables</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">data_class</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">perms</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
                    <span class="n">pas</span><span class="o">.</span><span class="n">space</span><span class="p">[</span><span class="n">perms</span><span class="p">][</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>
                    <span class="n">pas</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perms</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>

        <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">pas</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">pas</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.MMUShell.virtspace" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">virtspace</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">lvl</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">uperms</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">hierarchical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">))</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Recursively reconstruct virtual address space</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">virtspace</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">addr</span><span class="p">,</span>
    <span class="n">lvl</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">prefix</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">uperms</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">hierarchical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="p">,</span>
    <span class="n">cache</span><span class="o">=</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively reconstruct virtual address space&quot;&quot;&quot;</span>

    <span class="n">virtspace</span> <span class="o">=</span> <span class="n">VAS</span><span class="p">()</span>
    <span class="n">data_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_datapages_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">]</span>
    <span class="n">ptr_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_ptr_entries_to_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">]</span>
    <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">portion</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">lvl</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">radix_levels</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">data_class</span> <span class="ow">in</span> <span class="n">data_classes</span><span class="p">:</span>
            <span class="n">shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_entries_to_shifts</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">data_class</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">entry_idx</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">data_class</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">permissions</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
                <span class="n">virt_addr</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">|</span> <span class="p">(</span><span class="n">entry_idx</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">)</span>
                <span class="n">virtspace</span><span class="p">[</span><span class="n">permissions</span><span class="p">]</span> <span class="o">|=</span> <span class="n">portion</span><span class="o">.</span><span class="n">closedopen</span><span class="p">(</span>
                    <span class="n">virt_addr</span><span class="p">,</span> <span class="n">virt_addr</span> <span class="o">+</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>
                <span class="p">)</span>

        <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">virtspace</span>
        <span class="k">return</span> <span class="n">virtspace</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ptr_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_entries_to_shifts</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">ptr_class</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">entry_idx</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">ptr_class</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">permissions</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>

                    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
                        <span class="n">virt_addr</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">|</span> <span class="p">(</span><span class="n">entry_idx</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">)</span>
                        <span class="n">low_virts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">virtspace</span><span class="p">(</span>
                            <span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
                            <span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="n">virt_addr</span><span class="p">,</span>
                            <span class="n">permissions</span><span class="p">,</span>
                            <span class="n">hierarchical</span><span class="o">=</span><span class="n">hierarchical</span><span class="p">,</span>
                            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
                            <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">low_virts</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">entry</span><span class="o">.</span><span class="n">address</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">hierarchical</span><span class="p">:</span>
                        <span class="n">virtspace</span><span class="o">.</span><span class="n">hierarchical_extend</span><span class="p">(</span><span class="n">low_virts</span><span class="p">,</span> <span class="n">uperms</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">virtspace</span><span class="o">.</span><span class="n">hierarchical_extend</span><span class="p">(</span><span class="n">low_virts</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">data_class</span> <span class="ow">in</span> <span class="n">data_classes</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">data_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span><span class="o">.</span><span class="n">entries</span>
                <span class="ow">and</span> <span class="n">data_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">):</span>
                <span class="n">shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">map_entries_to_shifts</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">data_class</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">entry_idx</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">page_tables</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">entries</span><span class="p">[</span><span class="n">data_class</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">):</span>
                    <span class="n">permissions</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
                    <span class="n">virt_addr</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">|</span> <span class="p">(</span><span class="n">entry_idx</span> <span class="o">&lt;&lt;</span> <span class="n">shift</span><span class="p">)</span>
                    <span class="n">virtspace</span><span class="p">[</span><span class="n">permissions</span><span class="p">]</span> <span class="o">|=</span> <span class="n">portion</span><span class="o">.</span><span class="n">closedopen</span><span class="p">(</span>
                        <span class="n">virt_addr</span><span class="p">,</span> <span class="n">virt_addr</span> <span class="o">+</span> <span class="n">entry</span><span class="o">.</span><span class="n">size</span>
                    <span class="p">)</span>

        <span class="n">cache</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">virtspace</span>
        <span class="k">return</span> <span class="n">virtspace</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.Machine" class="doc doc-heading">
          <code>Machine</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Represents a generic machine</p>
<p>A machine is composed by a CPU, a MMU and a memory. It is able to parse the memory in parallel and to extract the dataflow of the registers.</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.Machine.cpu">cpu</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the CPU of the machine</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.Machine.mmu">mmu</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the MMU of the machine</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.Machine.memory">memory</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the memory of the machine</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.Machine.gtruth">gtruth</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the ground truth of the machine</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.Machine.data">data</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the data of the machine</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Machine</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a generic machine</span>

<span class="sd">    A machine is composed by a CPU, a MMU and a memory. It is able to parse the memory in parallel and to extract the dataflow of the registers.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        cpu: the CPU of the machine</span>
<span class="sd">        mmu: the MMU of the machine</span>
<span class="sd">        memory: the memory of the machine</span>
<span class="sd">        gtruth: the ground truth of the machine</span>
<span class="sd">        data: the data of the machine</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_machine_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">machine_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a machine starting from a YAML file descriptor</span>

<span class="sd">        Args:</span>
<span class="sd">            machine_config: the YAML file descriptor</span>
<span class="sd">            **kwargs: additional arguments</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new Machine object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check no intersection between memory regions</span>
        <span class="n">ram_portion</span> <span class="o">=</span> <span class="n">portion</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">region_dict</span> <span class="ow">in</span> <span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;memspace&quot;</span><span class="p">][</span><span class="s2">&quot;ram&quot;</span><span class="p">]:</span>
            <span class="n">region_portion</span> <span class="o">=</span> <span class="n">portion</span><span class="o">.</span><span class="n">closed</span><span class="p">(</span><span class="n">region_dict</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span> <span class="n">region_dict</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ram_portion</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">region_portion</span><span class="p">)</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s2">&quot;RAM regions overlapping!&quot;</span><span class="p">)</span>
                <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ram_portion</span> <span class="o">=</span> <span class="n">ram_portion</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">region_portion</span><span class="p">)</span>

        <span class="c1"># Module to use</span>
        <span class="n">architecture_module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span>
            <span class="s2">&quot;architectures.&quot;</span> <span class="o">+</span> <span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;cpu&quot;</span><span class="p">][</span><span class="s2">&quot;architecture&quot;</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># Create CPU</span>
        <span class="n">cpu</span> <span class="o">=</span> <span class="n">architecture_module</span><span class="o">.</span><span class="n">CPU</span><span class="o">.</span><span class="n">from_cpu_config</span><span class="p">(</span><span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;cpu&quot;</span><span class="p">])</span>

        <span class="c1"># Create MMU</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mmu_class</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="n">architecture_module</span><span class="p">,</span> <span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;mmu&quot;</span><span class="p">][</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s2">&quot;Unknown MMU mode!&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mmu</span> <span class="o">=</span> <span class="n">mmu_class</span><span class="p">(</span><span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;mmu&quot;</span><span class="p">])</span>

        <span class="c1"># Create RAM</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="n">architecture_module</span><span class="o">.</span><span class="n">PhysicalMemory</span><span class="p">(</span><span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;memspace&quot;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">architecture_module</span><span class="o">.</span><span class="n">Machine</span><span class="p">(</span><span class="n">cpu</span><span class="p">,</span> <span class="n">mmu</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cpu</span><span class="p">,</span> <span class="n">mmu</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Machine</span>

<span class="sd">        Args:</span>
<span class="sd">            cpu: the CPU of the machine</span>
<span class="sd">            mmu: the MMU of the machine</span>
<span class="sd">            memory: the memory of the machine</span>
<span class="sd">            **kwargs: additional arguments</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpu</span> <span class="o">=</span> <span class="n">cpu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mmu</span> <span class="o">=</span> <span class="n">mmu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="n">memory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gtruth</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpu</span><span class="o">.</span><span class="n">machine</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">machine</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">machine</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_miasm_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the Miasm machine</span>

<span class="sd">        Aimed to be overloaded by child classes</span>

<span class="sd">        Returns:</span>
<span class="sd">            the Miasm machine</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">apply_parallel</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">parallel_func</span><span class="p">,</span> <span class="n">iterators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_address</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run parallel_func using multiple core to frame_size chunks of RAM or iterators arguments</span>

<span class="sd">        Only used in child classes for parsing memory</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_size: the size of the frame to parse</span>
<span class="sd">            parallel_func: the function to run in parallel</span>
<span class="sd">            iterators: the iterators to use</span>
<span class="sd">            max_address: the maximum address to parse</span>
<span class="sd">            **kwargs: additional arguments</span>

<span class="sd">        Returns:</span>
<span class="sd">            a list of the results of parallel_func</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Prepare the pool</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parsing memory...&quot;</span><span class="p">)</span>
        <span class="n">cpus</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">cpus</span><span class="p">,</span> <span class="n">initializer</span><span class="o">=</span><span class="n">tqdm</span><span class="o">.</span><span class="n">set_lock</span><span class="p">,</span> <span class="n">initargs</span><span class="o">=</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">Lock</span><span class="p">(),))</span>

        <span class="k">if</span> <span class="n">iterators</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Create iterators for parallel execution</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">addresses_iterators</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">get_addresses</span><span class="p">(</span>
                <span class="n">frame_size</span><span class="p">,</span> <span class="n">cpus</span><span class="o">=</span><span class="n">cpus</span><span class="p">,</span> <span class="n">max_address</span><span class="o">=</span><span class="n">max_address</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">addresses_iterators</span> <span class="o">=</span> <span class="n">iterators</span>

        <span class="c1"># GO!</span>
        <span class="n">parsing_results_async</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span>
                <span class="n">parallel_func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">addresses_iterator</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">pidx</span><span class="p">),</span> <span class="n">kwds</span><span class="o">=</span><span class="n">kwargs</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">addresses_iterator</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">addresses_iterators</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Workaround for tqdm</span>

        <span class="k">return</span> <span class="n">parsing_results_async</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.Machine.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">cpu</span><span class="p">,</span> <span class="n">mmu</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize the Machine</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>cpu</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the CPU of the machine</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>mmu</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the MMU of the machine</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>memory</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the memory of the machine</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>additional arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cpu</span><span class="p">,</span> <span class="n">mmu</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the Machine</span>

<span class="sd">    Args:</span>
<span class="sd">        cpu: the CPU of the machine</span>
<span class="sd">        mmu: the MMU of the machine</span>
<span class="sd">        memory: the memory of the machine</span>
<span class="sd">        **kwargs: additional arguments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cpu</span> <span class="o">=</span> <span class="n">cpu</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mmu</span> <span class="o">=</span> <span class="n">mmu</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="n">memory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gtruth</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cpu</span><span class="o">.</span><span class="n">machine</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mmu</span><span class="o">.</span><span class="n">machine</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">machine</span> <span class="o">=</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.Machine.apply_parallel" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">apply_parallel</span><span class="p">(</span><span class="n">frame_size</span><span class="p">,</span> <span class="n">parallel_func</span><span class="p">,</span> <span class="n">iterators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_address</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Run parallel_func using multiple core to frame_size chunks of RAM or iterators arguments</p>
<p>Only used in child classes for parsing memory</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>frame_size</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the frame to parse</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>parallel_func</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the function to run in parallel</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>iterators</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the iterators to use</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>max_address</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the maximum address to parse</p>
            </div>
          </td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>additional arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a list of the results of parallel_func</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_parallel</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">parallel_func</span><span class="p">,</span> <span class="n">iterators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_address</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run parallel_func using multiple core to frame_size chunks of RAM or iterators arguments</span>

<span class="sd">    Only used in child classes for parsing memory</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_size: the size of the frame to parse</span>
<span class="sd">        parallel_func: the function to run in parallel</span>
<span class="sd">        iterators: the iterators to use</span>
<span class="sd">        max_address: the maximum address to parse</span>
<span class="sd">        **kwargs: additional arguments</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list of the results of parallel_func</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Prepare the pool</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parsing memory...&quot;</span><span class="p">)</span>
    <span class="n">cpus</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">cpus</span><span class="p">,</span> <span class="n">initializer</span><span class="o">=</span><span class="n">tqdm</span><span class="o">.</span><span class="n">set_lock</span><span class="p">,</span> <span class="n">initargs</span><span class="o">=</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">Lock</span><span class="p">(),))</span>

    <span class="k">if</span> <span class="n">iterators</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Create iterators for parallel execution</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">addresses_iterators</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">get_addresses</span><span class="p">(</span>
            <span class="n">frame_size</span><span class="p">,</span> <span class="n">cpus</span><span class="o">=</span><span class="n">cpus</span><span class="p">,</span> <span class="n">max_address</span><span class="o">=</span><span class="n">max_address</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">addresses_iterators</span> <span class="o">=</span> <span class="n">iterators</span>

    <span class="c1"># GO!</span>
    <span class="n">parsing_results_async</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span>
            <span class="n">parallel_func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">addresses_iterator</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="n">pidx</span><span class="p">),</span> <span class="n">kwds</span><span class="o">=</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">pidx</span><span class="p">,</span> <span class="n">addresses_iterator</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">addresses_iterators</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Workaround for tqdm</span>

    <span class="k">return</span> <span class="n">parsing_results_async</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.Machine.from_machine_config" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_machine_config</span><span class="p">(</span><span class="n">machine_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Create a machine starting from a YAML file descriptor</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>machine_config</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the YAML file descriptor</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>additional arguments</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a new Machine object</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_machine_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">machine_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a machine starting from a YAML file descriptor</span>

<span class="sd">    Args:</span>
<span class="sd">        machine_config: the YAML file descriptor</span>
<span class="sd">        **kwargs: additional arguments</span>

<span class="sd">    Returns:</span>
<span class="sd">        a new Machine object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check no intersection between memory regions</span>
    <span class="n">ram_portion</span> <span class="o">=</span> <span class="n">portion</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">region_dict</span> <span class="ow">in</span> <span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;memspace&quot;</span><span class="p">][</span><span class="s2">&quot;ram&quot;</span><span class="p">]:</span>
        <span class="n">region_portion</span> <span class="o">=</span> <span class="n">portion</span><span class="o">.</span><span class="n">closed</span><span class="p">(</span><span class="n">region_dict</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span> <span class="n">region_dict</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ram_portion</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">region_portion</span><span class="p">)</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s2">&quot;RAM regions overlapping!&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ram_portion</span> <span class="o">=</span> <span class="n">ram_portion</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">region_portion</span><span class="p">)</span>

    <span class="c1"># Module to use</span>
    <span class="n">architecture_module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span>
        <span class="s2">&quot;architectures.&quot;</span> <span class="o">+</span> <span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;cpu&quot;</span><span class="p">][</span><span class="s2">&quot;architecture&quot;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># Create CPU</span>
    <span class="n">cpu</span> <span class="o">=</span> <span class="n">architecture_module</span><span class="o">.</span><span class="n">CPU</span><span class="o">.</span><span class="n">from_cpu_config</span><span class="p">(</span><span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;cpu&quot;</span><span class="p">])</span>

    <span class="c1"># Create MMU</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mmu_class</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="n">architecture_module</span><span class="p">,</span> <span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;mmu&quot;</span><span class="p">][</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s2">&quot;Unknown MMU mode!&quot;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">mmu</span> <span class="o">=</span> <span class="n">mmu_class</span><span class="p">(</span><span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;mmu&quot;</span><span class="p">])</span>

    <span class="c1"># Create RAM</span>
    <span class="n">memory</span> <span class="o">=</span> <span class="n">architecture_module</span><span class="o">.</span><span class="n">PhysicalMemory</span><span class="p">(</span><span class="n">machine_config</span><span class="p">[</span><span class="s2">&quot;memspace&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">architecture_module</span><span class="o">.</span><span class="n">Machine</span><span class="p">(</span><span class="n">cpu</span><span class="p">,</span> <span class="n">mmu</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.Machine.get_miasm_machine" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_miasm_machine</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the Miasm machine</p>
<p>Aimed to be overloaded by child classes</p>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the Miasm machine</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_miasm_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the Miasm machine</span>

<span class="sd">    Aimed to be overloaded by child classes</span>

<span class="sd">    Returns:</span>
<span class="sd">        the Miasm machine</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.PAS" class="doc doc-heading">
          <code>PAS</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">

  
      <p>Represents a Physical Address Space</p>
<p>The Physical Address Space (PAS) is a hierarchical data structure that represents the SAS of the physical memory.
The PAS is composed of a set of entries, each one representing a set of contiguous physical addresses with the same permissions.
The PAS is organized in a hierarchical way, where each entry is identified by a set of permissions and contains a set of intervals of contiguous physical addresses.</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PAS.space">space</span></code></td>
          <td>
                <code><span title="typing.Dict">Dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the space of the PAS</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PAS.space_size">space_size</span></code></td>
          <td>
                <code><span title="typing.Dict">Dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the space</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Note: those attributes are initialized as defaultdicts to avoid the need of checking if a key is present before accessing it</p>

            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PAS</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a Physical Address Space</span>

<span class="sd">    The Physical Address Space (PAS) is a hierarchical data structure that represents the SAS of the physical memory.</span>
<span class="sd">    The PAS is composed of a set of entries, each one representing a set of contiguous physical addresses with the same permissions.</span>
<span class="sd">    The PAS is organized in a hierarchical way, where each entry is identified by a set of permissions and contains a set of intervals of contiguous physical addresses.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        space: the space of the PAS</span>
<span class="sd">        space_size: the size of the space</span>

<span class="sd">    Note: those attributes are initialized as defaultdicts to avoid the need of checking if a key is present before accessing it</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">space</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">))</span>
    <span class="n">space_size</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">hierarchical_extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">uperms</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extend this PAS with another PAS</span>

<span class="sd">        Args:</span>
<span class="sd">            other: the other PAS to extend with</span>
<span class="sd">            uperms: the permissions to use</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">space</span><span class="p">:</span>
            <span class="n">new_perm</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
                <span class="n">new_perm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">uperms</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">new_perm</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_perm</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">[</span><span class="n">new_perm</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">space</span><span class="p">[</span><span class="n">perm</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">new_perm</span><span class="p">]</span> <span class="o">+=</span> <span class="n">other</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a key is present in the PAS</span>

<span class="sd">        Args:</span>
<span class="sd">            key: the key to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the key is present, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">addresses</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">address</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">address</span> <span class="o">+</span> <span class="n">addresses</span><span class="p">[</span><span class="n">address</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">is_in_kernel_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a key is in the kernel space</span>

<span class="sd">        Args:</span>
<span class="sd">            key: the key to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the key is in the kernel space, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">perms</span><span class="p">,</span> <span class="n">addresses</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">perms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perms</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">address</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">address</span> <span class="o">+</span> <span class="n">addresses</span><span class="p">[</span><span class="n">address</span><span class="p">]:</span>
                        <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">is_in_kernel_x_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a key is in the kernel executable space</span>

<span class="sd">        Args:</span>
<span class="sd">            key: the key to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the key is in the kernel executable space, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">perms</span><span class="p">,</span> <span class="n">addresses</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">perms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">perms</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">address</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">address</span> <span class="o">+</span> <span class="n">addresses</span><span class="p">[</span><span class="n">address</span><span class="p">]:</span>
                        <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">is_in_user_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a key is in the user space</span>

<span class="sd">        Args:</span>
<span class="sd">            key: the key to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the key is in the user space, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">perms</span><span class="p">,</span> <span class="n">addresses</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">perms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perms</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">address</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">address</span> <span class="o">+</span> <span class="n">addresses</span><span class="p">[</span><span class="n">address</span><span class="p">]:</span>
                        <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the PAS&quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">:</span>
            <span class="n">symb</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}{}{}</span><span class="s2"> </span><span class="si">{}{}{}</span><span class="s2">: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;R&quot;</span><span class="p">),</span>
                <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;W&quot;</span><span class="p">),</span>
                <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;X&quot;</span><span class="p">),</span>
                <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;R&quot;</span><span class="p">),</span>
                <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;W&quot;</span><span class="p">),</span>
                <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;X&quot;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perm</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">get_kernel_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the size of the kernel space&quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perm</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perm</span><span class="p">[</span><span class="mi">5</span><span class="p">]):</span>
                <span class="n">size</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">size</span>

    <span class="k">def</span> <span class="nf">get_user_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the size of the user space&quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">perm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perm</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perm</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
                <span class="n">size</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">size</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PAS.__contains__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__contains__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if a key is present in the PAS</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>key</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the key to check</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if the key is present, False otherwise</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a key is present in the PAS</span>

<span class="sd">    Args:</span>
<span class="sd">        key: the key to check</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the key is present, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">addresses</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">address</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">address</span> <span class="o">+</span> <span class="n">addresses</span><span class="p">[</span><span class="n">address</span><span class="p">]:</span>
                <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PAS.__repr__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>String representation of the PAS</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;String representation of the PAS&quot;&quot;&quot;</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">:</span>
        <span class="n">symb</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span>
        <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}{}{}</span><span class="s2"> </span><span class="si">{}{}{}</span><span class="s2">: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;R&quot;</span><span class="p">),</span>
            <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;W&quot;</span><span class="p">),</span>
            <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;X&quot;</span><span class="p">),</span>
            <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;R&quot;</span><span class="p">),</span>
            <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;W&quot;</span><span class="p">),</span>
            <span class="n">symb</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;X&quot;</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perm</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PAS.get_kernel_size" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_kernel_size</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the size of the kernel space</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_kernel_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the size of the kernel space&quot;&quot;&quot;</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perm</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perm</span><span class="p">[</span><span class="mi">5</span><span class="p">]):</span>
            <span class="n">size</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">size</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PAS.get_user_size" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_user_size</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the size of the user space</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_user_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the size of the user space&quot;&quot;&quot;</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">perm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perm</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perm</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
            <span class="n">size</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">size</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PAS.hierarchical_extend" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">hierarchical_extend</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">uperms</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extend this PAS with another PAS</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>other</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the other PAS to extend with</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>uperms</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the permissions to use</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">hierarchical_extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">uperms</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extend this PAS with another PAS</span>

<span class="sd">    Args:</span>
<span class="sd">        other: the other PAS to extend with</span>
<span class="sd">        uperms: the permissions to use</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">space</span><span class="p">:</span>
        <span class="n">new_perm</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">new_perm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">uperms</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">new_perm</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_perm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">[</span><span class="n">new_perm</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">space</span><span class="p">[</span><span class="n">perm</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">new_perm</span><span class="p">]</span> <span class="o">+=</span> <span class="n">other</span><span class="o">.</span><span class="n">space_size</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PAS.is_in_kernel_space" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_in_kernel_space</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if a key is in the kernel space</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>key</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the key to check</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if the key is in the kernel space, False otherwise</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_in_kernel_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a key is in the kernel space</span>

<span class="sd">    Args:</span>
<span class="sd">        key: the key to check</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the key is in the kernel space, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">perms</span><span class="p">,</span> <span class="n">addresses</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">perms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perms</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">address</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">address</span> <span class="o">+</span> <span class="n">addresses</span><span class="p">[</span><span class="n">address</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PAS.is_in_kernel_x_space" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_in_kernel_x_space</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if a key is in the kernel executable space</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>key</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the key to check</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if the key is in the kernel executable space, False otherwise</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_in_kernel_x_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a key is in the kernel executable space</span>

<span class="sd">    Args:</span>
<span class="sd">        key: the key to check</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the key is in the kernel executable space, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">perms</span><span class="p">,</span> <span class="n">addresses</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">perms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">perms</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">address</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">address</span> <span class="o">+</span> <span class="n">addresses</span><span class="p">[</span><span class="n">address</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PAS.is_in_user_space" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_in_user_space</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if a key is in the user space</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>key</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the key to check</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if the key is in the user space, False otherwise</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_in_user_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a key is in the user space</span>

<span class="sd">    Args:</span>
<span class="sd">        key: the key to check</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the key is in the user space, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">perms</span><span class="p">,</span> <span class="n">addresses</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">perms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">perms</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">address</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">address</span> <span class="o">+</span> <span class="n">addresses</span><span class="p">[</span><span class="n">address</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.PageTable" class="doc doc-heading">
          <code>PageTable</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Represents a Page Table</p>
<p>A page table is the data structure used by a virtual memory system in a computer operating system to store the mapping between virtual addresses and physical addresses.</p>
<p>Aimed to be inherited by child classes to represent different architectures</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PageTable.address">address</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the address of the page table</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PageTable.size">size</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the page table</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PageTable.entries">entries</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the entries of the page table</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PageTable.levels">levels</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the levels of the page table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PageTable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a Page Table</span>

<span class="sd">    A page table is the data structure used by a virtual memory system in a computer operating system to store the mapping between virtual addresses and physical addresses.</span>

<span class="sd">    Aimed to be inherited by child classes to represent different architectures</span>

<span class="sd">    Attributes:</span>
<span class="sd">        address: the address of the page table</span>
<span class="sd">        size: the size of the page table</span>
<span class="sd">        entries: the entries of the page table</span>
<span class="sd">        levels: the levels of the page table</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">entry_size</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Page Table</span>

<span class="sd">        Args:</span>
<span class="sd">            address: the address of the page table</span>
<span class="sd">            size: the size of the page table</span>
<span class="sd">            entries: the entries of the page table</span>
<span class="sd">            levels: the levels of the page table</span>
<span class="sd">            *args: additional arguments</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="n">levels</span>

    <span class="k">def</span> <span class="nf">apply_on_entries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">function</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run a function to all the entries of the page table.</span>

<span class="sd">        The provided function should take an entry and the arguments as input and return the result of the operation.</span>

<span class="sd">        Args:</span>
<span class="sd">            f: the function to apply</span>
<span class="sd">            args: the arguments to pass to the function</span>

<span class="sd">        Returns:</span>
<span class="sd">            a list with the results of the function applied to all the entries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PageTable.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize the Page Table</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>address</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the address of the page table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>size</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the page table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>entries</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the entries of the page table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>levels</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the levels of the page table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>*args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>additional arguments</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the Page Table</span>

<span class="sd">    Args:</span>
<span class="sd">        address: the address of the page table</span>
<span class="sd">        size: the size of the page table</span>
<span class="sd">        entries: the entries of the page table</span>
<span class="sd">        levels: the levels of the page table</span>
<span class="sd">        *args: additional arguments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="n">levels</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PageTable.apply_on_entries" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">apply_on_entries</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Run a function to all the entries of the page table.</p>
<p>The provided function should take an entry and the arguments as input and return the result of the operation.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>f</code></td>
          <td>
                <code>function</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the function to apply</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the arguments to pass to the function</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a list with the results of the function applied to all the entries</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_on_entries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">function</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a function to all the entries of the page table.</span>

<span class="sd">    The provided function should take an entry and the arguments as input and return the result of the operation.</span>

<span class="sd">    Args:</span>
<span class="sd">        f: the function to apply</span>
<span class="sd">        args: the arguments to pass to the function</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list with the results of the function applied to all the entries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.PhysicalMemory" class="doc doc-heading">
          <code>PhysicalMemory</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Represents the physical memory of a machine</p>
<p>The physical memory is composed by a set of memory regions, each one representing a set of contiguous physical addresses with the same permissions.</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PhysicalMemory._is_opened">_is_opened</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a flag to check if the memory is opened</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PhysicalMemory._miasm_vm">_miasm_vm</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the Miasm VM</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PhysicalMemory._memregions">_memregions</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the memory regions</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PhysicalMemory._memsize">_memsize</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the memory</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PhysicalMemory.physpace">physpace</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the physical space</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.PhysicalMemory.raw_configuration">raw_configuration</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the raw configuration of the memory</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PhysicalMemory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents the physical memory of a machine</span>

<span class="sd">    The physical memory is composed by a set of memory regions, each one representing a set of contiguous physical addresses with the same permissions.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        _is_opened: a flag to check if the memory is opened</span>
<span class="sd">        _miasm_vm: the Miasm VM</span>
<span class="sd">        _memregions: the memory regions</span>
<span class="sd">        _memsize: the size of the memory</span>
<span class="sd">        physpace: the physical space</span>
<span class="sd">        raw_configuration: the raw configuration of the memory</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">machine</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deepcopy the PhysicalMemory object&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">PhysicalMemory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_configuration</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy the PhysicalMemory object&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">PhysicalMemory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_configuration</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the state of the PhysicalMemory object&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reopen</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the state of the PhysicalMemory object&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reopen</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">regions_defs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the PhysicalMemory</span>

<span class="sd">        Args:</span>
<span class="sd">            regions_defs: the regions definitions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_opened</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_memsize</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ram&quot;</span><span class="p">:</span> <span class="n">portion</span><span class="o">.</span><span class="n">empty</span><span class="p">(),</span> <span class="s2">&quot;not_ram&quot;</span><span class="p">:</span> <span class="n">portion</span><span class="o">.</span><span class="n">empty</span><span class="p">()}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_configuration</span> <span class="o">=</span> <span class="n">regions_defs</span>

        <span class="c1"># Load dump RAM files</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">region_def</span> <span class="ow">in</span> <span class="n">regions_defs</span><span class="p">[</span><span class="s2">&quot;ram&quot;</span><span class="p">]:</span>
                <span class="c1"># Load the dump file for a memory region</span>
                <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;dumpfile&quot;</span><span class="p">],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
                <span class="n">mm</span> <span class="o">=</span> <span class="n">mmap</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MAP_SHARED</span><span class="p">,</span> <span class="n">PROT_READ</span><span class="p">)</span>
                <span class="n">mm</span><span class="o">.</span><span class="n">madvise</span><span class="p">(</span><span class="n">MADV_HUGEPAGE</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_memsize</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span>
                <span class="n">region_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">region_size</span> <span class="o">!=</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
                        <span class="s2">&quot;Declared size </span><span class="si">{}</span><span class="s2"> is different from real size </span><span class="si">{}</span><span class="s2"> for: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="n">region_size</span><span class="p">,</span>
                            <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;dumpfile&quot;</span><span class="p">],</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;dumpfile&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;fd&quot;</span><span class="p">:</span> <span class="n">fd</span><span class="p">,</span>
                        <span class="s2">&quot;mmap&quot;</span><span class="p">:</span> <span class="n">mm</span><span class="p">,</span>
                        <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">region_size</span><span class="p">,</span>
                        <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">],</span>
                    <span class="p">}</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;ram&quot;</span><span class="p">]</span> <span class="o">|=</span> <span class="n">portion</span><span class="o">.</span><span class="n">closed</span><span class="p">(</span>
                    <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_opened</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Error in opening dump files! Error: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

        <span class="c1"># Load not RAM regions</span>
        <span class="k">for</span> <span class="n">region_def</span> <span class="ow">in</span> <span class="n">regions_defs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;not_ram&quot;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;not_ram&quot;</span><span class="p">]</span> <span class="o">|=</span> <span class="n">portion</span><span class="o">.</span><span class="n">closed</span><span class="p">(</span>
                <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;not_valid_regions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;not_ram&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;ram&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;defined_regions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;not_ram&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;ram&quot;</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the size of the memory&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memsize</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a key is in the memory&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span>
        <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;ram&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Close the memory&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="k">del</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span>
                    <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="k">del</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span>
                    <span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_opened</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">reopen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reopen the memory&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="p">:</span>
            <span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">region</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
            <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mmap</span><span class="p">(</span><span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MAP_SHARED</span><span class="p">,</span> <span class="n">PROT_READ</span><span class="p">)</span>
            <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">madvise</span><span class="p">(</span><span class="n">MADV_HUGEPAGE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_opened</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get data from the memory&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">][</span>
                    <span class="n">start</span> <span class="o">-</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="n">start</span> <span class="o">-</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">size</span>
                <span class="p">]</span>
        <span class="k">return</span> <span class="nb">bytearray</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_addresses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">align_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cpus</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_address</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the addresses of the memory</span>

<span class="sd">        Return a list contains tuples (for a total of cpus tuples).</span>
<span class="sd">        Each tuple contains the len of the iterator, and an iterator over part of all the addresses aligned to align_offset and distanced by size present in RAM regions.</span>

<span class="sd">        Args:</span>
<span class="sd">            size: the size of the addresses</span>
<span class="sd">            align_offset: the alignment offset</span>
<span class="sd">            cpus: the number of cpus</span>
<span class="sd">            max_address: the maximum address</span>

<span class="sd">        Returns:</span>
<span class="sd">            a tuple containing the total elements and the addresses</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[]</span>

        <span class="n">ranges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">multi_ranges</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cpus</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="p">:</span>
            <span class="n">region_start</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
            <span class="n">region_end</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">region_start</span> <span class="o">&gt;=</span> <span class="n">max_address</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">align_offset</span> <span class="o">&gt;</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">max_address</span> <span class="o">&lt;</span> <span class="n">region_end</span><span class="p">:</span>
                <span class="n">chunk_end</span> <span class="o">=</span> <span class="n">max_address</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">chunk_end</span> <span class="o">=</span> <span class="n">region_end</span>

            <span class="n">original_r</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">region_start</span> <span class="o">+</span> <span class="n">align_offset</span><span class="p">,</span> <span class="n">chunk_end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">cpus</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ranges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">original_r</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Split the iterator over the region in cpus iterators</span>
                <span class="n">range_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_r</span><span class="p">)</span> <span class="o">//</span> <span class="n">cpus</span> <span class="o">*</span> <span class="n">size</span>
                <span class="k">if</span> <span class="n">range_size</span> <span class="o">&lt;=</span> <span class="n">size</span><span class="p">:</span>
                    <span class="n">range_size</span> <span class="o">=</span> <span class="n">size</span>
                    <span class="n">vcpus</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_r</span><span class="p">)</span> <span class="o">//</span> <span class="n">size</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vcpus</span> <span class="o">=</span> <span class="n">cpus</span>

                <span class="n">first_elem</span> <span class="o">=</span> <span class="n">region_start</span> <span class="o">+</span> <span class="n">align_offset</span>
                <span class="n">multi_ranges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="nb">range</span><span class="p">(</span><span class="n">first_elem</span><span class="p">,</span> <span class="n">region_start</span> <span class="o">+</span> <span class="n">range_size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="n">prev_last</span> <span class="o">=</span> <span class="n">region_start</span> <span class="o">+</span> <span class="n">range_size</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">vcpus</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_last</span> <span class="o">-</span> <span class="n">align_offset</span> <span class="o">-</span> <span class="n">region_start</span><span class="p">)</span> <span class="o">%</span> <span class="n">size</span>
                    <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">first_elem</span> <span class="o">=</span> <span class="n">prev_last</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">first_elem</span> <span class="o">=</span> <span class="n">prev_last</span> <span class="o">+</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span>

                    <span class="n">last_elem</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">range_size</span> <span class="o">+</span> <span class="n">region_start</span>
                    <span class="n">multi_ranges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">first_elem</span><span class="p">,</span> <span class="n">last_elem</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>

                    <span class="n">prev_last</span> <span class="o">=</span> <span class="n">last_elem</span>

                <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_last</span> <span class="o">-</span> <span class="n">align_offset</span> <span class="o">-</span> <span class="n">region_start</span><span class="p">)</span> <span class="o">%</span> <span class="n">size</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">first_elem</span> <span class="o">=</span> <span class="n">prev_last</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">first_elem</span> <span class="o">=</span> <span class="n">prev_last</span> <span class="o">+</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">first_elem</span> <span class="o">&gt;</span> <span class="n">chunk_end</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">multi_ranges</span><span class="p">[</span><span class="n">vcpus</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">first_elem</span><span class="p">,</span> <span class="n">chunk_end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">cpus</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">total_elems</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ranges</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">total_elems</span><span class="p">,</span> <span class="p">[</span><span class="n">total_elems</span><span class="p">,</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">ranges</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">total_elems</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cpus</span><span class="p">):</span>
                <span class="n">elems_in_iter</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">multi_ranges</span><span class="p">[</span><span class="n">cid</span><span class="p">]])</span>
                <span class="n">total_elems</span> <span class="o">+=</span> <span class="n">elems_in_iter</span>
                <span class="n">multi_ranges</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">elems_in_iter</span><span class="p">,</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">multi_ranges</span><span class="p">[</span><span class="n">cid</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">total_elems</span><span class="p">,</span> <span class="n">multi_ranges</span>

    <span class="k">def</span> <span class="nf">get_miasm_vmmngr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load each RAM file in a MIASM virtual memory region</span>

<span class="sd">        Returns:</span>
<span class="sd">            the Miasm VM</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span>

        <span class="n">vm</span> <span class="o">=</span> <span class="n">Vm</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">region_def</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="p">:</span>
            <span class="n">vm</span><span class="o">.</span><span class="n">add_memory_page</span><span class="p">(</span>
                <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span>
                <span class="n">PAGE_READ</span> <span class="o">|</span> <span class="n">PAGE_WRITE</span> <span class="o">|</span> <span class="n">PAGE_EXEC</span><span class="p">,</span>
                <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
                <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span> <span class="o">=</span> <span class="n">vm</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span>

    <span class="k">def</span> <span class="nf">get_memregions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the memory regions&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span>

    <span class="k">def</span> <span class="nf">free_miasm_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Free the Miasm memory&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.__contains__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__contains__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if a key is in the memory</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a key is in the memory&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span>
    <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;ram&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.__copy__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__copy__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Copy the PhysicalMemory object</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy the PhysicalMemory object&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PhysicalMemory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_configuration</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.__deepcopy__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__deepcopy__</span><span class="p">(</span><span class="n">memo</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Deepcopy the PhysicalMemory object</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deepcopy the PhysicalMemory object&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PhysicalMemory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_configuration</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.__getstate__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__getstate__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the state of the PhysicalMemory object</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the state of the PhysicalMemory object&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span><span class="p">:</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reopen</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">regions_defs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize the PhysicalMemory</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>regions_defs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the regions definitions</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">regions_defs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the PhysicalMemory</span>

<span class="sd">    Args:</span>
<span class="sd">        regions_defs: the regions definitions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_opened</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_memsize</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ram&quot;</span><span class="p">:</span> <span class="n">portion</span><span class="o">.</span><span class="n">empty</span><span class="p">(),</span> <span class="s2">&quot;not_ram&quot;</span><span class="p">:</span> <span class="n">portion</span><span class="o">.</span><span class="n">empty</span><span class="p">()}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw_configuration</span> <span class="o">=</span> <span class="n">regions_defs</span>

    <span class="c1"># Load dump RAM files</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">region_def</span> <span class="ow">in</span> <span class="n">regions_defs</span><span class="p">[</span><span class="s2">&quot;ram&quot;</span><span class="p">]:</span>
            <span class="c1"># Load the dump file for a memory region</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;dumpfile&quot;</span><span class="p">],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
            <span class="n">mm</span> <span class="o">=</span> <span class="n">mmap</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MAP_SHARED</span><span class="p">,</span> <span class="n">PROT_READ</span><span class="p">)</span>
            <span class="n">mm</span><span class="o">.</span><span class="n">madvise</span><span class="p">(</span><span class="n">MADV_HUGEPAGE</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_memsize</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span>
            <span class="n">region_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">region_size</span> <span class="o">!=</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
                    <span class="s2">&quot;Declared size </span><span class="si">{}</span><span class="s2"> is different from real size </span><span class="si">{}</span><span class="s2"> for: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">region_size</span><span class="p">,</span>
                        <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;dumpfile&quot;</span><span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;dumpfile&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;fd&quot;</span><span class="p">:</span> <span class="n">fd</span><span class="p">,</span>
                    <span class="s2">&quot;mmap&quot;</span><span class="p">:</span> <span class="n">mm</span><span class="p">,</span>
                    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">region_size</span><span class="p">,</span>
                    <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">],</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;ram&quot;</span><span class="p">]</span> <span class="o">|=</span> <span class="n">portion</span><span class="o">.</span><span class="n">closed</span><span class="p">(</span>
                <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_opened</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Error in opening dump files! Error: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="c1"># Load not RAM regions</span>
    <span class="k">for</span> <span class="n">region_def</span> <span class="ow">in</span> <span class="n">regions_defs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;not_ram&quot;</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;not_ram&quot;</span><span class="p">]</span> <span class="o">|=</span> <span class="n">portion</span><span class="o">.</span><span class="n">closed</span><span class="p">(</span>
            <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span> <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;not_valid_regions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;not_ram&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;ram&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;defined_regions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;not_ram&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">physpace</span><span class="p">[</span><span class="s2">&quot;ram&quot;</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.__len__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the size of the memory</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the size of the memory&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memsize</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.__setstate__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Set the state of the PhysicalMemory object</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the state of the PhysicalMemory object&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reopen</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.close" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Close the memory</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Close the memory&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span>
                <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span>
                <span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">continue</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_opened</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.free_miasm_memory" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">free_miasm_memory</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Free the Miasm memory</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">free_miasm_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Free the Miasm memory&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.get_addresses" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_addresses</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">align_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cpus</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_address</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the addresses of the memory</p>
<p>Return a list contains tuples (for a total of cpus tuples).
Each tuple contains the len of the iterator, and an iterator over part of all the addresses aligned to align_offset and distanced by size present in RAM regions.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>size</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the addresses</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>align_offset</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the alignment offset</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>cpus</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of cpus</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>max_address</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the maximum address</p>
            </div>
          </td>
          <td>
                <code>-1</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a tuple containing the total elements and the addresses</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_addresses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">align_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cpus</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_address</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the addresses of the memory</span>

<span class="sd">    Return a list contains tuples (for a total of cpus tuples).</span>
<span class="sd">    Each tuple contains the len of the iterator, and an iterator over part of all the addresses aligned to align_offset and distanced by size present in RAM regions.</span>

<span class="sd">    Args:</span>
<span class="sd">        size: the size of the addresses</span>
<span class="sd">        align_offset: the alignment offset</span>
<span class="sd">        cpus: the number of cpus</span>
<span class="sd">        max_address: the maximum address</span>

<span class="sd">    Returns:</span>
<span class="sd">        a tuple containing the total elements and the addresses</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[]</span>

    <span class="n">ranges</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">multi_ranges</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cpus</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="p">:</span>
        <span class="n">region_start</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
        <span class="n">region_end</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">region_start</span> <span class="o">&gt;=</span> <span class="n">max_address</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">align_offset</span> <span class="o">&gt;</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">max_address</span> <span class="o">&lt;</span> <span class="n">region_end</span><span class="p">:</span>
            <span class="n">chunk_end</span> <span class="o">=</span> <span class="n">max_address</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chunk_end</span> <span class="o">=</span> <span class="n">region_end</span>

        <span class="n">original_r</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">region_start</span> <span class="o">+</span> <span class="n">align_offset</span><span class="p">,</span> <span class="n">chunk_end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cpus</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ranges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">original_r</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Split the iterator over the region in cpus iterators</span>
            <span class="n">range_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_r</span><span class="p">)</span> <span class="o">//</span> <span class="n">cpus</span> <span class="o">*</span> <span class="n">size</span>
            <span class="k">if</span> <span class="n">range_size</span> <span class="o">&lt;=</span> <span class="n">size</span><span class="p">:</span>
                <span class="n">range_size</span> <span class="o">=</span> <span class="n">size</span>
                <span class="n">vcpus</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_r</span><span class="p">)</span> <span class="o">//</span> <span class="n">size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vcpus</span> <span class="o">=</span> <span class="n">cpus</span>

            <span class="n">first_elem</span> <span class="o">=</span> <span class="n">region_start</span> <span class="o">+</span> <span class="n">align_offset</span>
            <span class="n">multi_ranges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="nb">range</span><span class="p">(</span><span class="n">first_elem</span><span class="p">,</span> <span class="n">region_start</span> <span class="o">+</span> <span class="n">range_size</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">prev_last</span> <span class="o">=</span> <span class="n">region_start</span> <span class="o">+</span> <span class="n">range_size</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">vcpus</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_last</span> <span class="o">-</span> <span class="n">align_offset</span> <span class="o">-</span> <span class="n">region_start</span><span class="p">)</span> <span class="o">%</span> <span class="n">size</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">first_elem</span> <span class="o">=</span> <span class="n">prev_last</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">first_elem</span> <span class="o">=</span> <span class="n">prev_last</span> <span class="o">+</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span>

                <span class="n">last_elem</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">range_size</span> <span class="o">+</span> <span class="n">region_start</span>
                <span class="n">multi_ranges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">first_elem</span><span class="p">,</span> <span class="n">last_elem</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>

                <span class="n">prev_last</span> <span class="o">=</span> <span class="n">last_elem</span>

            <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_last</span> <span class="o">-</span> <span class="n">align_offset</span> <span class="o">-</span> <span class="n">region_start</span><span class="p">)</span> <span class="o">%</span> <span class="n">size</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">first_elem</span> <span class="o">=</span> <span class="n">prev_last</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">first_elem</span> <span class="o">=</span> <span class="n">prev_last</span> <span class="o">+</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">first_elem</span> <span class="o">&gt;</span> <span class="n">chunk_end</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">multi_ranges</span><span class="p">[</span><span class="n">vcpus</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">first_elem</span><span class="p">,</span> <span class="n">chunk_end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">cpus</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">total_elems</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ranges</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">total_elems</span><span class="p">,</span> <span class="p">[</span><span class="n">total_elems</span><span class="p">,</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">ranges</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">total_elems</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cpus</span><span class="p">):</span>
            <span class="n">elems_in_iter</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">multi_ranges</span><span class="p">[</span><span class="n">cid</span><span class="p">]])</span>
            <span class="n">total_elems</span> <span class="o">+=</span> <span class="n">elems_in_iter</span>
            <span class="n">multi_ranges</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">elems_in_iter</span><span class="p">,</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">multi_ranges</span><span class="p">[</span><span class="n">cid</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">total_elems</span><span class="p">,</span> <span class="n">multi_ranges</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.get_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_data</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get data from the memory</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get data from the memory&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">][</span>
                <span class="n">start</span> <span class="o">-</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="n">start</span> <span class="o">-</span> <span class="n">region</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">size</span>
            <span class="p">]</span>
    <span class="k">return</span> <span class="nb">bytearray</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.get_memregions" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_memregions</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the memory regions</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_memregions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the memory regions&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.get_miasm_vmmngr" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_miasm_vmmngr</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Load each RAM file in a MIASM virtual memory region</p>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the Miasm VM</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_miasm_vmmngr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load each RAM file in a MIASM virtual memory region</span>

<span class="sd">    Returns:</span>
<span class="sd">        the Miasm VM</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span>

    <span class="n">vm</span> <span class="o">=</span> <span class="n">Vm</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">region_def</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="p">:</span>
        <span class="n">vm</span><span class="o">.</span><span class="n">add_memory_page</span><span class="p">(</span>
            <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">],</span>
            <span class="n">PAGE_READ</span> <span class="o">|</span> <span class="n">PAGE_WRITE</span> <span class="o">|</span> <span class="n">PAGE_EXEC</span><span class="p">,</span>
            <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
            <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">region_def</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span> <span class="o">=</span> <span class="n">vm</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_miasm_vm</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.PhysicalMemory.reopen" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">reopen</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Reopen the memory</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reopen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reopen the memory&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memregions</span><span class="p">:</span>
        <span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">region</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
        <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mmap</span><span class="p">(</span><span class="n">region</span><span class="p">[</span><span class="s2">&quot;fd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MAP_SHARED</span><span class="p">,</span> <span class="n">PROT_READ</span><span class="p">)</span>
        <span class="n">region</span><span class="p">[</span><span class="s2">&quot;mmap&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">madvise</span><span class="p">(</span><span class="n">MADV_HUGEPAGE</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_opened</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.RadixTree" class="doc doc-heading">
          <code>RadixTree</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Represents a Radix Tree</p>
<p>Radix trees maintain a hierarchical representation of the SAS. Each tree is composed by N-1 levels of
directory tables, each containing entries that either point to tables of the lower level or to a physical
memory page (huge pages), whose size depends on the level itself.
The final level is composed of page tables that point only to same-size physical memory pages.
The tree root is the physical address of the directory table of Level 0 and it identifies uniquely the SAS
and, consequently, the process to which it is assigned. This address is stored in a special system register
(here generically called RADIX_ROOT) by the operating system and it is used by the MMU to locate the radix
tree when it starts a new translation.
The translation performed by the MMU starts from the root table pointed by the address contained in RADIX_ROOT:
the MMU then divides the segmented address into two parts: a prefix and a page offset.
The prefix part is divided into a series of N chunks that represent the hierarchical sequence of indexes to be
used to locate the entry inside a table of the corresponding level. This process ends when an entry points to
a physical page. At this point, the MMU returns the concatenation of the page offset extracted by the segmented
address to the physical page address found in the last page table entry.</p>
<p>Aimed to be inherited by child classes to represent different architectures</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.RadixTree.top_table">top_table</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the address of the top table</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.RadixTree.init_level">init_level</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the initial level of the radix tree</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.RadixTree.pas">pas</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the Physical Address Space</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.RadixTree.vas">vas</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the Virtual Address Space</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.RadixTree.kernel">kernel</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if the kernel space is enabled</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.RadixTree.user">user</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if the user space is enabled</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RadixTree</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a Radix Tree</span>

<span class="sd">    Radix trees maintain a hierarchical representation of the SAS. Each tree is composed by N-1 levels of</span>
<span class="sd">    directory tables, each containing entries that either point to tables of the lower level or to a physical</span>
<span class="sd">    memory page (huge pages), whose size depends on the level itself.</span>
<span class="sd">    The final level is composed of page tables that point only to same-size physical memory pages.</span>
<span class="sd">    The tree root is the physical address of the directory table of Level 0 and it identifies uniquely the SAS</span>
<span class="sd">    and, consequently, the process to which it is assigned. This address is stored in a special system register</span>
<span class="sd">    (here generically called RADIX_ROOT) by the operating system and it is used by the MMU to locate the radix</span>
<span class="sd">    tree when it starts a new translation.</span>
<span class="sd">    The translation performed by the MMU starts from the root table pointed by the address contained in RADIX_ROOT:</span>
<span class="sd">    the MMU then divides the segmented address into two parts: a prefix and a page offset.</span>
<span class="sd">    The prefix part is divided into a series of N chunks that represent the hierarchical sequence of indexes to be</span>
<span class="sd">    used to locate the entry inside a table of the corresponding level. This process ends when an entry points to</span>
<span class="sd">    a physical page. At this point, the MMU returns the concatenation of the page offset extracted by the segmented</span>
<span class="sd">    address to the physical page address found in the last page table entry.</span>

<span class="sd">    Aimed to be inherited by child classes to represent different architectures</span>

<span class="sd">    Attributes:</span>
<span class="sd">        top_table: the address of the top table</span>
<span class="sd">        init_level: the initial level of the radix tree</span>
<span class="sd">        pas: the Physical Address Space</span>
<span class="sd">        vas: the Virtual Address Space</span>
<span class="sd">        kernel: if the kernel space is enabled</span>
<span class="sd">        user: if the user space is enabled</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Radix address&quot;</span><span class="p">,</span>
        <span class="s2">&quot;First level&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Kernel size (Bytes)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;User size (Bytes)&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">addr_fmt</span> <span class="o">=</span> <span class="s2">&quot;0x</span><span class="si">{:016x}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top_table</span><span class="p">,</span> <span class="n">init_level</span><span class="p">,</span> <span class="n">pas</span><span class="p">,</span> <span class="n">vas</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Radix Tree</span>

<span class="sd">        Args:</span>
<span class="sd">            top_table: the address of the top table</span>
<span class="sd">            init_level: the initial level of the radix tree</span>
<span class="sd">            pas: the Physical Address Space</span>
<span class="sd">            vas: the Virtual Address Space</span>
<span class="sd">            kernel: if the kernel space is enabled</span>
<span class="sd">            user: if the user space is enabled</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top_table</span> <span class="o">=</span> <span class="n">top_table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_level</span> <span class="o">=</span> <span class="n">init_level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pas</span> <span class="o">=</span> <span class="n">pas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vas</span> <span class="o">=</span> <span class="n">vas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">user</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the Radix Tree&quot;&quot;&quot;</span>
        <span class="n">e_resume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_resume_stringified</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e_resume</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">))]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">entry_resume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the resume of the Radix Tree</span>

<span class="sd">        Returns:</span>
<span class="sd">            a list with the resume of the Radix Tree</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">top_table</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_level</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pas</span><span class="o">.</span><span class="n">get_kernel_size</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pas</span><span class="o">.</span><span class="n">get_user_size</span><span class="p">(),</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">entry_resume_stringified</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the resume of the Radix Tree as string</span>

<span class="sd">        Returns:</span>
<span class="sd">            a list with the resume of the Radix Tree as string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_resume</span><span class="p">()</span>
        <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addr_fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.RadixTree.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">top_table</span><span class="p">,</span> <span class="n">init_level</span><span class="p">,</span> <span class="n">pas</span><span class="p">,</span> <span class="n">vas</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize the Radix Tree</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>top_table</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the address of the top table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>init_level</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the initial level of the radix tree</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>pas</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the Physical Address Space</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>vas</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the Virtual Address Space</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>kernel</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if the kernel space is enabled</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>user</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if the user space is enabled</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top_table</span><span class="p">,</span> <span class="n">init_level</span><span class="p">,</span> <span class="n">pas</span><span class="p">,</span> <span class="n">vas</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the Radix Tree</span>

<span class="sd">    Args:</span>
<span class="sd">        top_table: the address of the top table</span>
<span class="sd">        init_level: the initial level of the radix tree</span>
<span class="sd">        pas: the Physical Address Space</span>
<span class="sd">        vas: the Virtual Address Space</span>
<span class="sd">        kernel: if the kernel space is enabled</span>
<span class="sd">        user: if the user space is enabled</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">top_table</span> <span class="o">=</span> <span class="n">top_table</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_level</span> <span class="o">=</span> <span class="n">init_level</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pas</span> <span class="o">=</span> <span class="n">pas</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vas</span> <span class="o">=</span> <span class="n">vas</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">user</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.RadixTree.__repr__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>String representation of the Radix Tree</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;String representation of the Radix Tree&quot;&quot;&quot;</span>
    <span class="n">e_resume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_resume_stringified</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e_resume</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">))]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.RadixTree.entry_resume" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">entry_resume</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the resume of the Radix Tree</p>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a list with the resume of the Radix Tree</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">entry_resume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the resume of the Radix Tree</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list with the resume of the Radix Tree</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top_table</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_level</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pas</span><span class="o">.</span><span class="n">get_kernel_size</span><span class="p">(),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pas</span><span class="o">.</span><span class="n">get_user_size</span><span class="p">(),</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.RadixTree.entry_resume_stringified" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">entry_resume_stringified</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the resume of the Radix Tree as string</p>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a list with the resume of the Radix Tree as string</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">entry_resume_stringified</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the resume of the Radix Tree as string</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list with the resume of the Radix Tree as string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_resume</span><span class="p">()</span>
    <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addr_fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">res</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.TableEntry" class="doc doc-heading">
          <code>TableEntry</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Represents a table Page Table Entry</p>
<p>It holds the mapping between a virtual address of a page and the address of a physical frame.
There is also auxiliary information about the page such as a present bit, a dirty or modified bit, address space or process ID information, amongst others.</p>
<p>Aimed to be inherited by child classes to represent different architectures</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.TableEntry.address">address</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the virtual address of the page</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.TableEntry.flags">flags</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the flags of the page</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TableEntry</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a table Page Table Entry</span>

<span class="sd">    It holds the mapping between a virtual address of a page and the address of a physical frame.</span>
<span class="sd">    There is also auxiliary information about the page such as a present bit, a dirty or modified bit, address space or process ID information, amongst others.</span>

<span class="sd">    Aimed to be inherited by child classes to represent different architectures</span>

<span class="sd">    Attributes:</span>
<span class="sd">        address: the virtual address of the page</span>
<span class="sd">        flags: the flags of the page</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Table Entry</span>

<span class="sd">        Args:</span>
<span class="sd">            address: the virtual address of the page</span>
<span class="sd">            flags: the flags of the page</span>
<span class="sd">            *args: additional arguments</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.TableEntry.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize the Table Entry</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>address</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the virtual address of the page</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>flags</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the flags of the page</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>*args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>additional arguments</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the Table Entry</span>

<span class="sd">    Args:</span>
<span class="sd">        address: the virtual address of the page</span>
<span class="sd">        flags: the flags of the page</span>
<span class="sd">        *args: additional arguments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="mmushell.architectures.generic.VAS" class="doc doc-heading">
          <code>VAS</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="collections.defaultdict">defaultdict</span></code></p>

  
      <p>Represents a Virtual Address Space</p>
<p>The Virtual Address Space (VAS) is a hierarchical data structure that represents the SAS of a process.
The VAS is composed of a set of entries, each one representing a set of contiguous virtual addresses
with the same permissions. The VAS is organized in a hierarchical way, where each entry is identified by
a set of permissions and contains a set of intervals of contiguous virtual addresses.</p>
<p>Aimed to be inherited by child classes to represent different architectures</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="mmushell.architectures.generic.VAS.default_factory">default_factory</span></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the default interval for the VAS</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Note: the default_factory is initialized as an empty interval to avoid the need of checking if a key is present before accessing it</p>

            <details class="quote">
              <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">VAS</span><span class="p">(</span><span class="n">defaultdict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a Virtual Address Space</span>

<span class="sd">    The Virtual Address Space (VAS) is a hierarchical data structure that represents the SAS of a process.</span>
<span class="sd">    The VAS is composed of a set of entries, each one representing a set of contiguous virtual addresses</span>
<span class="sd">    with the same permissions. The VAS is organized in a hierarchical way, where each entry is identified by</span>
<span class="sd">    a set of permissions and contains a set of intervals of contiguous virtual addresses.</span>

<span class="sd">    Aimed to be inherited by child classes to represent different architectures</span>

<span class="sd">    Attributes:</span>
<span class="sd">        default_factory: the default interval for the VAS</span>

<span class="sd">    Note: the default_factory is initialized as an empty interval to avoid the need of checking if a key is present before accessing it</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VAS</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_factory</span> <span class="o">=</span> <span class="n">portion</span><span class="o">.</span><span class="n">empty</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the VAS&quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">k_str</span> <span class="o">=</span> <span class="n">perms_bool_to_string</span><span class="p">(</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">k_str</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">[</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">interval</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">interval</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">hierarchical_extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">uperms</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extend this VAS with another VAS</span>

<span class="sd">        Args:</span>
<span class="sd">            other: the other VAS to extend with</span>
<span class="sd">            uperms: the permissions to use</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">other</span><span class="p">:</span>
            <span class="n">new_perm</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
                <span class="n">new_perm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">uperms</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">new_perm</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_perm</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">new_perm</span><span class="p">]</span> <span class="o">|=</span> <span class="n">other</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.VAS.__repr__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>String representation of the VAS</p>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;String representation of the VAS&quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">k_str</span> <span class="o">=</span> <span class="n">perms_bool_to_string</span><span class="p">(</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">k_str</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">[</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">interval</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">interval</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">s</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="mmushell.architectures.generic.VAS.hierarchical_extend" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">hierarchical_extend</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">uperms</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extend this VAS with another VAS</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>other</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the other VAS to extend with</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>uperms</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the permissions to use</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">hierarchical_extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">uperms</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extend this VAS with another VAS</span>

<span class="sd">    Args:</span>
<span class="sd">        other: the other VAS to extend with</span>
<span class="sd">        uperms: the permissions to use</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">other</span><span class="p">:</span>
        <span class="n">new_perm</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">new_perm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">uperms</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">new_perm</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_perm</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">new_perm</span><span class="p">]</span> <span class="o">|=</span> <span class="n">other</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>



<div class="doc doc-object doc-function">



<h2 id="mmushell.architectures.generic.perms_bool_to_string" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">perms_bool_to_string</span><span class="p">(</span><span class="n">kr</span><span class="p">,</span> <span class="n">kw</span><span class="p">,</span> <span class="n">kx</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Convert a set of permissions from boolean to string</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>kr</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>read permission for the kernel</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>kw</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>write permission for the kernel</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>kx</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>execute permission for the kernel</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>r</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>read permission for the user</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>w</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>write permission for the user</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>x</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>execute permission for the user</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a string with the permissions</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>mmushell/architectures/generic.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">perms_bool_to_string</span><span class="p">(</span><span class="n">kr</span><span class="p">,</span> <span class="n">kw</span><span class="p">,</span> <span class="n">kx</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a set of permissions from boolean to string</span>

<span class="sd">    Args:</span>
<span class="sd">        kr: read permission for the kernel</span>
<span class="sd">        kw: write permission for the kernel</span>
<span class="sd">        kx: execute permission for the kernel</span>
<span class="sd">        r: read permission for the user</span>
<span class="sd">        w: write permission for the user</span>
<span class="sd">        x: execute permission for the user</span>

<span class="sd">    Returns:</span>
<span class="sd">        a string with the permissions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">perm_s</span> <span class="o">=</span> <span class="s2">&quot;R&quot;</span> <span class="k">if</span> <span class="n">kr</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span>
    <span class="n">perm_s</span> <span class="o">+=</span> <span class="s2">&quot;W&quot;</span> <span class="k">if</span> <span class="n">kw</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span>
    <span class="n">perm_s</span> <span class="o">+=</span> <span class="s2">&quot;X&quot;</span> <span class="k">if</span> <span class="n">kx</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span>
    <span class="n">perm_s</span> <span class="o">+=</span> <span class="s2">&quot;r&quot;</span> <span class="k">if</span> <span class="n">r</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span>
    <span class="n">perm_s</span> <span class="o">+=</span> <span class="s2">&quot;w&quot;</span> <span class="k">if</span> <span class="n">w</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span>
    <span class="n">perm_s</span> <span class="o">+=</span> <span class="s2">&quot;x&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span>
    <span class="k">return</span> <span class="n">perm_s</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">April 25, 2024</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">April 25, 2024</span>
  </span>

    
    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="Contributors">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/standard3" class="md-author" title="@standard3">
          
          <img src="https://avatars.githubusercontent.com/u/67806187?v=4&size=72" alt="standard3">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["search.suggest", "search.highlight", "search.share", "content.action.edit", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.path", "navigation.top"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.dd8806f2.min.js"></script>
      
    
  </body>
</html>